### Preprocessing ###

Reading DAPI image
D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\morphology_mip_small.tif
DAPI shape h: 1800 w: 2400
Segmenting DAPI patches h: 1800 w: 2400
Nuclei image h: 382 w: 510
Finished segmenting, found 852 nuclei
Loading transcripts file
   Unnamed: 0    transcript_id  cell_id  ...  y_location z_location         qv
0     2565587  281496451551924       -1  ...   469.34515  10.958567  40.000000
1     2565590  281496451551927    44769  ...   327.25198  15.099401  40.000000
2     2565591  281496451551928    45392  ...   577.32130  11.937755  20.782797
3     2565592  281496451551929    46672  ...   365.75200  10.617414  40.000000
4     2565595  281496451551932       -1  ...   409.68720  11.384081  40.000000

[5 rows x 9 columns]
Filtering transcripts
Finished filtering
Saving csv...
<bound method NDFrame.head of         Unnamed: 0    transcript_id  cell_id  ...  y_location z_location         qv
0          2565587  281496451551924       -1  ...         257  10.958567  40.000000
1          2565590  281496451551927    44769  ...         115  15.099401  40.000000
2          2565591  281496451551928    45392  ...         365  11.937755  20.782797
3          2565592  281496451551929    46672  ...         154  10.617414  40.000000
4          2565595  281496451551932       -1  ...         198  11.384081  40.000000
...            ...              ...      ...  ...         ...        ...        ...
186141     3940032  281500747163393    43575  ...         243  16.281252  35.923073
186142     3940037  281500747163399    43517  ...           2  15.730230  40.000000
186143     3940039  281500747163401    43534  ...          37  15.751373  27.767600
186144     3940041  281500747163403    43543  ...         299  12.549458  40.000000
186145     3940042  281500747163404    43530  ...          26  17.624292  28.487734

[186146 rows x 9 columns]>
(186146, 9)
313 unique genes
Total height 382, width 510
Converting to maps
Patch: (0, 382, 0, 510)
Saved all maps
(382, 510)
Processing D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\expr_maps\all_genes_0_382_0_510.hdf5
Loaded gene expr maps from D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\expr_maps\all_genes_0_382_0_510.hdf5
[0, 382, 0, 510]
Shift by 0
88 patches
Shift by 24
70 patches
Number of cells 852
Number of splits for multiprocessing: 8
Done
Number of cells: 852
Number of splits for multiprocessing: 8
Computing simple annotation

### Training ###

Using device: cuda
2025-12-22 21:16:56,133 INFO Initialising model
Number of genes: 313
2025-12-22 21:16:56,802 INFO Preparing data
Loaded nuclei
(382, 510)
63 patches available
Cell types: ['B', 'CD4Tconv/Treg', 'CD8T/CD8Tex', 'DC', 'Endothelial', 'Epithelial', 'Fibroblasts', 'Malignant', 'Mast', 'Mono/Macro', 'Myofibroblasts', 'NK', 'Neutrophils', 'Plasma', 'SMC']
2025-12-22 21:16:56,835 INFO Total number of training examples: 63
2025-12-22 21:16:56,836 INFO Begin training

Epoch = 1  lr = 1e-05
Epoch[1/5], Step[0], Loss:3460.0127
NE:0.5967, TC:203.6237, CC:1842.3898, OV:0.0551, PN:1413.3472
2025-12-22 21:16:59,129 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_1_step_0.pth
Epoch[1/5], Step[1], Loss:3248.8359
NE:0.5481, TC:204.3023, CC:1632.7750, OV:7.2125, PN:1403.9982
Epoch[1/5], Step[2], Loss:2970.1909
NE:0.5373, TC:195.0527, CC:1411.0433, OV:6.7501, PN:1356.8075
Epoch[1/5], Step[3], Loss:2789.2681
NE:0.5471, TC:191.3615, CC:1292.5034, OV:6.3124, PN:1298.5436
Epoch[1/5], Step[4], Loss:2550.1821
NE:0.5439, TC:192.5899, CC:1147.6497, OV:4.1095, PN:1205.2893
Epoch[1/5], Step[5], Loss:2639.4333
NE:0.6109, TC:195.7432, CC:1040.0742, OV:0.0303, PN:1402.9749
Epoch[1/5], Step[6], Loss:2263.3860
NE:0.5924, TC:181.8775, CC:910.0845, OV:0.9011, PN:1169.9305
Epoch[1/5], Step[7], Loss:2255.6191
NE:0.6224, TC:174.8903, CC:788.4704, OV:9.6633, PN:1281.9727
Epoch[1/5], Step[8], Loss:2326.8447
NE:0.6111, TC:171.6636, CC:775.9219, OV:0.8589, PN:1377.7894
Epoch[1/5], Step[9], Loss:2265.4624
NE:0.6183, TC:167.6445, CC:777.6149, OV:2.6744, PN:1316.9102
Epoch[1/5], Step[10], Loss:2367.7466
NE:0.5844, TC:165.5021, CC:732.0290, OV:1.7689, PN:1467.8622
Epoch[1/5], Step[11], Loss:1725.5398
NE:0.6274, TC:160.2814, CC:658.0685, OV:8.2973, PN:898.2651
Epoch[1/5], Step[12], Loss:1916.5087
NE:0.5998, TC:155.1132, CC:685.8741, OV:3.5565, PN:1071.3651
Epoch[1/5], Step[13], Loss:2222.7202
NE:0.5763, TC:146.8550, CC:580.5940, OV:1.7356, PN:1492.9592
Epoch[1/5], Step[14], Loss:1839.8774
NE:0.5853, TC:153.8076, CC:643.2050, OV:3.1094, PN:1039.1700
Epoch[1/5], Step[15], Loss:2033.0667
NE:0.5692, TC:155.8170, CC:714.1168, OV:1.7312, PN:1160.8325
Epoch[1/5], Step[16], Loss:2061.0513
NE:0.5959, TC:152.3467, CC:641.0520, OV:4.3848, PN:1262.6720
Epoch[1/5], Step[17], Loss:1618.6072
NE:0.5942, TC:142.0352, CC:516.6217, OV:6.1235, PN:953.2325
Epoch[1/5], Step[18], Loss:1687.9583
NE:0.5563, TC:140.8734, CC:536.5723, OV:6.0600, PN:1003.8964
Epoch[1/5], Step[19], Loss:1877.7549
NE:0.5627, TC:144.5952, CC:526.8164, OV:6.9557, PN:1198.8248
Epoch[1/5], Step[20], Loss:1725.6044
NE:0.4938, TC:134.6703, CC:588.9008, OV:1.7010, PN:999.8386
Epoch[1/5], Step[21], Loss:1721.3722
NE:0.5201, TC:138.1480, CC:548.8344, OV:6.4118, PN:1027.4580
Epoch[1/5], Step[22], Loss:1376.3359
NE:0.5371, TC:134.5524, CC:498.9324, OV:7.7324, PN:734.5815
Epoch[1/5], Step[23], Loss:1691.7654
NE:0.5188, TC:129.9351, CC:518.9401, OV:5.1843, PN:1037.1870
Epoch[1/5], Step[24], Loss:1201.9199
NE:0.5293, TC:132.8011, CC:472.8065, OV:7.7384, PN:588.0447
Epoch[1/5], Step[25], Loss:1657.3289
NE:0.5199, TC:136.3100, CC:613.2452, OV:5.6243, PN:901.6295
Epoch[1/5], Step[26], Loss:1704.9680
NE:0.5112, TC:130.1922, CC:558.4009, OV:2.1290, PN:1013.7346
Epoch[1/5], Step[27], Loss:1720.7430
NE:0.4941, TC:121.1282, CC:513.7233, OV:1.2241, PN:1084.1732
Epoch[1/5], Step[28], Loss:1379.4324
NE:0.4628, TC:122.1605, CC:503.9570, OV:3.8495, PN:749.0025
Epoch[1/5], Step[29], Loss:1818.9360
NE:0.4918, TC:128.4929, CC:499.1541, OV:0.7846, PN:1190.0126
Epoch[1/5], Step[30], Loss:1584.5168
NE:0.4823, TC:126.3576, CC:549.9294, OV:0.7907, PN:906.9568
Epoch[1/5], Step[31], Loss:1420.2357
NE:0.3785, TC:106.5644, CC:568.8422, OV:0.3509, PN:744.0999
Epoch[1/5], Step[32], Loss:1560.0570
NE:0.4621, TC:118.3175, CC:473.8784, OV:2.9413, PN:964.4578
Epoch[1/5], Step[33], Loss:1524.6104
NE:0.4723, TC:119.0556, CC:502.2755, OV:2.5064, PN:900.3006
Epoch[1/5], Step[34], Loss:1377.0308
NE:0.4493, TC:111.5654, CC:493.9575, OV:6.2975, PN:764.7610
Epoch[1/5], Step[35], Loss:1742.2129
NE:0.4606, TC:112.6251, CC:502.8959, OV:0.7692, PN:1125.4620
Epoch[1/5], Step[36], Loss:1274.1677
NE:0.4736, TC:117.3527, CC:413.1953, OV:9.2426, PN:733.9035
Epoch[1/5], Step[37], Loss:1204.6316
NE:0.4623, TC:114.6774, CC:398.1035, OV:8.4520, PN:682.9363
Epoch[1/5], Step[38], Loss:1039.7539
NE:0.4664, TC:113.1533, CC:376.3388, OV:9.2465, PN:540.5490
Epoch[1/5], Step[39], Loss:1325.2639
NE:0.4778, TC:115.5395, CC:406.5759, OV:7.6187, PN:795.0521
Epoch[1/5], Step[40], Loss:1341.4558
NE:0.4200, TC:99.0132, CC:366.6570, OV:0.7525, PN:874.6133
Epoch[1/5], Step[41], Loss:1425.3765
NE:0.3908, TC:99.6385, CC:499.5590, OV:2.9116, PN:822.8765
Epoch[1/5], Step[42], Loss:1120.4281
NE:0.4551, TC:111.0469, CC:368.4397, OV:9.2249, PN:631.2615
Epoch[1/5], Step[43], Loss:1261.6411
NE:0.4359, TC:108.0260, CC:379.1009, OV:8.3938, PN:765.6844
Epoch[1/5], Step[44], Loss:1353.4290
NE:0.4177, TC:106.3338, CC:488.3329, OV:6.6668, PN:751.6778
Epoch[1/5], Step[45], Loss:1440.8596
NE:0.4241, TC:107.7812, CC:501.7332, OV:9.1460, PN:821.7750
Epoch[1/5], Step[46], Loss:1282.6548
NE:0.4209, TC:97.2218, CC:384.6646, OV:4.6542, PN:795.6933
Epoch[1/5], Step[47], Loss:897.4742
NE:0.4398, TC:103.0329, CC:327.4565, OV:6.7689, PN:459.7760
Epoch[1/5], Step[48], Loss:1070.6569
NE:0.4340, TC:100.1744, CC:315.9608, OV:9.1917, PN:644.8959
Epoch[1/5], Step[49], Loss:1231.4756
NE:0.4528, TC:99.1330, CC:357.1953, OV:7.9161, PN:766.7784
Epoch[1/5], Step[50], Loss:1239.7997
NE:0.3962, TC:94.5558, CC:431.7810, OV:1.6109, PN:711.4557
Epoch[1/5], Step[51], Loss:1232.8870
NE:0.3841, TC:91.5757, CC:427.5869, OV:0.7141, PN:712.6262
Epoch[1/5], Step[52], Loss:1442.4670
NE:0.4545, TC:109.2089, CC:436.7346, OV:7.9298, PN:888.1394
Epoch[1/5], Step[53], Loss:1072.3916
NE:0.4521, TC:100.2902, CC:334.4009, OV:5.4748, PN:631.7736
Epoch[1/5], Step[54], Loss:1456.2598
NE:0.4175, TC:97.2521, CC:412.4338, OV:0.0245, PN:946.1318
Epoch[1/5], Step[55], Loss:1097.7518
NE:0.4343, TC:95.2724, CC:327.4458, OV:5.4392, PN:669.1602
Epoch[1/5], Step[56], Loss:1278.1887
NE:0.3608, TC:90.4954, CC:350.9746, OV:0.0007, PN:836.3573
Epoch[1/5], Step[57], Loss:1170.3484
NE:0.4324, TC:97.8281, CC:305.0803, OV:7.1083, PN:759.8993
Epoch[1/5], Step[58], Loss:1222.9314
NE:0.3901, TC:92.6797, CC:396.6946, OV:2.8381, PN:730.3287
Epoch[1/5], Step[59], Loss:1131.5720
NE:0.3255, TC:83.2362, CC:378.7432, OV:2.4058, PN:666.8613
Epoch[1/5], Step[60], Loss:894.6663
NE:0.3876, TC:88.6317, CC:304.4608, OV:6.2387, PN:494.9474
2025-12-22 21:18:03,978 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_1_step_60.pth
Epoch[1/5], Step[61], Loss:1040.7294
NE:0.4150, TC:92.7528, CC:310.3843, OV:7.4859, PN:629.6913
Epoch[1/5], Step[62], Loss:1277.3906
NE:0.3695, TC:89.8792, CC:523.4735, OV:2.9125, PN:660.7559

Epoch = 2  lr = 9.092830723281e-06
Epoch[2/5], Step[0], Loss:1201.8936
NE:0.3717, TC:91.2972, CC:439.7162, OV:6.5675, PN:663.9409
2025-12-22 21:18:08,037 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_2_step_0.pth
Epoch[2/5], Step[1], Loss:967.3927
NE:0.4040, TC:95.4287, CC:300.4250, OV:9.1333, PN:562.0016
Epoch[2/5], Step[2], Loss:1144.9221
NE:0.3150, TC:79.3266, CC:451.4857, OV:0.3187, PN:613.4761
Epoch[2/5], Step[3], Loss:1053.3403
NE:0.3996, TC:97.0328, CC:320.9278, OV:9.1283, PN:625.8518
Epoch[2/5], Step[4], Loss:1098.9246
NE:0.3257, TC:79.6938, CC:366.4890, OV:0.6942, PN:651.7219
Epoch[2/5], Step[5], Loss:825.0261
NE:0.4111, TC:89.6798, CC:266.8652, OV:7.5098, PN:460.5602
Epoch[2/5], Step[6], Loss:1268.9224
NE:0.3644, TC:87.2891, CC:506.3449, OV:2.8996, PN:672.0244
Epoch[2/5], Step[7], Loss:1110.8052
NE:0.4112, TC:92.5312, CC:271.5409, OV:7.0802, PN:739.2418
Epoch[2/5], Step[8], Loss:1264.6981
NE:0.3849, TC:92.3629, CC:427.7621, OV:9.0250, PN:735.1632
Epoch[2/5], Step[9], Loss:960.0181
NE:0.3064, TC:74.7665, CC:343.9504, OV:1.5340, PN:539.4608
Epoch[2/5], Step[10], Loss:1157.3079
NE:0.4202, TC:99.1540, CC:394.9211, OV:5.4291, PN:657.3835
Epoch[2/5], Step[11], Loss:1104.2850
NE:0.3124, TC:82.0394, CC:293.8173, OV:0.0007, PN:728.1152
Epoch[2/5], Step[12], Loss:1210.3429
NE:0.3593, TC:79.7931, CC:411.9819, OV:2.8441, PN:715.3646
Epoch[2/5], Step[13], Loss:1273.8873
NE:0.4003, TC:88.1833, CC:384.7212, OV:4.0898, PN:796.4927
Epoch[2/5], Step[14], Loss:1043.9963
NE:0.4273, TC:92.8446, CC:253.5069, OV:8.3201, PN:688.8975
Epoch[2/5], Step[15], Loss:1444.0658
NE:0.4296, TC:97.4443, CC:319.7723, OV:0.7340, PN:1025.6855
Epoch[2/5], Step[16], Loss:722.1406
NE:0.4198, TC:90.4629, CC:246.0016, OV:6.7059, PN:378.5504
Epoch[2/5], Step[17], Loss:995.9370
NE:0.3250, TC:73.4034, CC:253.1083, OV:0.7104, PN:668.3900
Epoch[2/5], Step[18], Loss:1181.4048
NE:0.3418, TC:80.6195, CC:315.6833, OV:0.0241, PN:784.7360
Epoch[2/5], Step[19], Loss:1130.3575
NE:0.3801, TC:87.6770, CC:342.6182, OV:2.4065, PN:697.2758
Epoch[2/5], Step[20], Loss:1280.9858
NE:0.4061, TC:96.6721, CC:385.3862, OV:7.8431, PN:790.6784
Epoch[2/5], Step[21], Loss:1003.9390
NE:0.3875, TC:85.5068, CC:261.7317, OV:5.7736, PN:650.5394
Epoch[2/5], Step[22], Loss:903.4744
NE:0.3784, TC:84.7823, CC:262.1440, OV:5.7984, PN:550.3713
Epoch[2/5], Step[23], Loss:1358.8127
NE:0.3517, TC:82.7342, CC:402.5157, OV:0.7195, PN:872.4917
Epoch[2/5], Step[24], Loss:1051.8525
NE:0.2636, TC:63.2856, CC:263.3893, OV:0.0169, PN:724.8972
Epoch[2/5], Step[25], Loss:1019.5587
NE:0.3892, TC:88.2255, CC:295.3000, OV:7.4489, PN:628.1953
Epoch[2/5], Step[26], Loss:1178.6412
NE:0.3545, TC:84.5929, CC:320.4194, OV:6.5964, PN:766.6782
Epoch[2/5], Step[27], Loss:1043.9783
NE:0.3184, TC:78.9285, CC:335.5715, OV:6.0724, PN:623.0876
Epoch[2/5], Step[28], Loss:1035.8149
NE:0.2907, TC:69.9771, CC:317.5391, OV:1.1212, PN:646.8869
Epoch[2/5], Step[29], Loss:1033.1140
NE:0.2870, TC:71.0217, CC:298.0499, OV:0.6931, PN:663.0623
Epoch[2/5], Step[30], Loss:841.1675
NE:0.3720, TC:84.5178, CC:251.7382, OV:8.2785, PN:496.2611
Epoch[2/5], Step[31], Loss:936.1734
NE:0.3843, TC:86.8463, CC:259.4862, OV:5.4221, PN:584.0345
Epoch[2/5], Step[32], Loss:884.9153
NE:0.3577, TC:79.7045, CC:265.8573, OV:5.8452, PN:533.1506
Epoch[2/5], Step[33], Loss:1045.3195
NE:0.2965, TC:72.0145, CC:403.6453, OV:1.5504, PN:567.8127
Epoch[2/5], Step[34], Loss:1206.8738
NE:0.2829, TC:69.3139, CC:369.0803, OV:1.5401, PN:766.6566
Epoch[2/5], Step[35], Loss:1016.5833
NE:0.3017, TC:73.9433, CC:346.3009, OV:2.3760, PN:593.6614
Epoch[2/5], Step[36], Loss:926.0340
NE:0.2801, TC:67.2153, CC:288.8559, OV:2.3554, PN:567.3273
Epoch[2/5], Step[37], Loss:1063.6478
NE:0.3367, TC:83.8842, CC:382.0742, OV:2.8670, PN:594.4857
Epoch[2/5], Step[38], Loss:913.4301
NE:0.3731, TC:81.1068, CC:239.0436, OV:6.2645, PN:586.6421
Epoch[2/5], Step[39], Loss:1091.7000
NE:0.3404, TC:79.7335, CC:310.0899, OV:2.8054, PN:698.7308
Epoch[2/5], Step[40], Loss:1146.9569
NE:0.3486, TC:82.2262, CC:335.8295, OV:1.9939, PN:726.5587
Epoch[2/5], Step[41], Loss:1061.8672
NE:0.3961, TC:88.6606, CC:228.5777, OV:9.0716, PN:735.1611
Epoch[2/5], Step[42], Loss:802.9301
NE:0.3988, TC:80.9185, CC:186.1305, OV:9.0912, PN:526.3911
Epoch[2/5], Step[43], Loss:962.3906
NE:0.3686, TC:77.0960, CC:278.4909, OV:7.7809, PN:598.6543
Epoch[2/5], Step[44], Loss:944.3320
NE:0.3039, TC:68.9881, CC:357.8244, OV:1.5452, PN:515.6703
Epoch[2/5], Step[45], Loss:717.8449
NE:0.3585, TC:74.7225, CC:214.1666, OV:6.1754, PN:422.4220
Epoch[2/5], Step[46], Loss:635.8990
NE:0.4031, TC:85.4068, CC:219.3753, OV:7.4751, PN:323.2388
Epoch[2/5], Step[47], Loss:695.9120
NE:0.4089, TC:85.2529, CC:203.9301, OV:9.1028, PN:397.2173
Epoch[2/5], Step[48], Loss:1109.8658
NE:0.3756, TC:83.9932, CC:413.1261, OV:3.6341, PN:608.7369
Epoch[2/5], Step[49], Loss:1112.9062
NE:0.3630, TC:87.8247, CC:379.7626, OV:0.7269, PN:644.2291
Epoch[2/5], Step[50], Loss:1014.2665
NE:0.3754, TC:81.3939, CC:359.3897, OV:3.2979, PN:569.8096
Epoch[2/5], Step[51], Loss:1101.5769
NE:0.4050, TC:81.8612, CC:269.2215, OV:4.9799, PN:745.1093
Epoch[2/5], Step[52], Loss:1007.9249
NE:0.3442, TC:76.7769, CC:293.1908, OV:2.7835, PN:634.8295
Epoch[2/5], Step[53], Loss:849.8079
NE:0.4067, TC:81.1886, CC:198.9407, OV:7.4233, PN:561.8486
Epoch[2/5], Step[54], Loss:782.9051
NE:0.3492, TC:72.8271, CC:212.0984, OV:3.6470, PN:493.9834
Epoch[2/5], Step[55], Loss:1001.7471
NE:0.4003, TC:77.1199, CC:211.2076, OV:4.5890, PN:708.4302
Epoch[2/5], Step[56], Loss:856.1453
NE:0.3973, TC:78.1824, CC:209.0054, OV:5.3610, PN:563.1992
Epoch[2/5], Step[57], Loss:681.7446
NE:0.4300, TC:83.1057, CC:181.1788, OV:7.8846, PN:409.1455
Epoch[2/5], Step[58], Loss:906.3471
NE:0.3547, TC:79.0304, CC:314.6528, OV:0.7347, PN:511.5745
Epoch[2/5], Step[59], Loss:1277.7750
NE:0.3415, TC:70.8692, CC:283.6362, OV:1.5507, PN:921.3773
Epoch[2/5], Step[60], Loss:940.5583
NE:0.3710, TC:76.0159, CC:278.8633, OV:6.0943, PN:579.2138
2025-12-22 21:19:09,715 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_2_step_60.pth
Epoch[2/5], Step[61], Loss:1085.4305
NE:0.4141, TC:87.1210, CC:243.9618, OV:6.6408, PN:747.2928
Epoch[2/5], Step[62], Loss:1273.2466
NE:0.2949, TC:65.8153, CC:669.1484, OV:0.0479, PN:537.9399

Epoch = 3  lr = 6.7178307232810015e-06
Epoch[3/5], Step[0], Loss:911.5444
NE:0.3691, TC:76.5479, CC:257.6757, OV:6.1031, PN:570.8486
2025-12-22 21:19:13,283 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_3_step_0.pth
Epoch[3/5], Step[1], Loss:778.1331
NE:0.4281, TC:84.5625, CC:180.0018, OV:8.2883, PN:504.8523
Epoch[3/5], Step[2], Loss:1129.4965
NE:0.3693, TC:80.0983, CC:309.4077, OV:4.0532, PN:735.5680
Epoch[3/5], Step[3], Loss:1011.2993
NE:0.3831, TC:83.6701, CC:318.9606, OV:2.8658, PN:605.4197
Epoch[3/5], Step[4], Loss:1319.6266
NE:0.3767, TC:74.0421, CC:249.5216, OV:1.5581, PN:994.1281
Epoch[3/5], Step[5], Loss:655.5865
NE:0.4404, TC:85.0474, CC:177.7540, OV:9.1071, PN:383.2376
Epoch[3/5], Step[6], Loss:876.3500
NE:0.3667, TC:82.3806, CC:280.3558, OV:0.7395, PN:512.5074
Epoch[3/5], Step[7], Loss:972.1132
NE:0.4331, TC:84.7018, CC:169.4089, OV:7.0407, PN:710.5287
Epoch[3/5], Step[8], Loss:853.1098
NE:0.2878, TC:63.6979, CC:281.9734, OV:1.5073, PN:505.6433
Epoch[3/5], Step[9], Loss:1252.6338
NE:0.2796, TC:65.7284, CC:641.1733, OV:0.0479, PN:545.4047
Epoch[3/5], Step[10], Loss:1183.6825
NE:0.4202, TC:92.6228, CC:304.2269, OV:7.8252, PN:778.5874
Epoch[3/5], Step[11], Loss:1035.6055
NE:0.4255, TC:86.9897, CC:197.7912, OV:9.0560, PN:741.3431
Epoch[3/5], Step[12], Loss:865.3590
NE:0.2779, TC:61.4619, CC:245.4672, OV:2.3392, PN:555.8127
Epoch[3/5], Step[13], Loss:584.3079
NE:0.4249, TC:85.0932, CC:186.7458, OV:7.4811, PN:304.5628
Epoch[3/5], Step[14], Loss:851.0829
NE:0.2936, TC:61.5150, CC:187.5480, OV:0.6904, PN:601.0358
Epoch[3/5], Step[15], Loss:873.6365
NE:0.4109, TC:80.7973, CC:182.4642, OV:6.2676, PN:603.6965
Epoch[3/5], Step[16], Loss:935.4564
NE:0.2837, TC:65.6737, CC:286.1695, OV:0.6704, PN:582.6591
Epoch[3/5], Step[17], Loss:841.6058
NE:0.3870, TC:75.7574, CC:200.4193, OV:5.3509, PN:559.6913
Epoch[3/5], Step[18], Loss:1012.1744
NE:0.3445, TC:77.4709, CC:232.2807, OV:2.7992, PN:699.2792
Epoch[3/5], Step[19], Loss:1287.5864
NE:0.3664, TC:77.5411, CC:333.3392, OV:0.7110, PN:875.6287
Epoch[3/5], Step[20], Loss:1097.5820
NE:0.2868, TC:67.4550, CC:274.5687, OV:1.5376, PN:753.7340
Epoch[3/5], Step[21], Loss:853.6067
NE:0.4029, TC:86.0334, CC:201.4818, OV:9.0584, PN:556.6301
Epoch[3/5], Step[22], Loss:887.7971
NE:0.2900, TC:66.2114, CC:217.2725, OV:1.1143, PN:602.9088
Epoch[3/5], Step[23], Loss:1003.1818
NE:0.3710, TC:83.3455, CC:236.4363, OV:6.6223, PN:676.4066
Epoch[3/5], Step[24], Loss:738.2570
NE:0.2897, TC:65.1607, CC:236.7732, OV:3.6201, PN:432.4132
Epoch[3/5], Step[25], Loss:1072.7760
NE:0.3359, TC:76.4102, CC:302.4988, OV:1.9790, PN:691.5521
Epoch[3/5], Step[26], Loss:679.8192
NE:0.3790, TC:75.7044, CC:192.7758, OV:7.4384, PN:403.5216
Epoch[3/5], Step[27], Loss:1003.2411
NE:0.2813, TC:67.7759, CC:376.3612, OV:1.5403, PN:557.2825
Epoch[3/5], Step[28], Loss:893.1643
NE:0.3766, TC:81.0938, CC:241.3617, OV:7.4062, PN:562.9260
Epoch[3/5], Step[29], Loss:797.2678
NE:0.2103, TC:50.6672, CC:174.1525, OV:0.0168, PN:572.2211
Epoch[3/5], Step[30], Loss:717.2108
NE:0.3920, TC:81.8359, CC:177.4092, OV:9.0487, PN:448.5248
Epoch[3/5], Step[31], Loss:717.5306
NE:0.3629, TC:74.2049, CC:161.3188, OV:9.0495, PN:472.5946
Epoch[3/5], Step[32], Loss:1075.6902
NE:0.3529, TC:78.2476, CC:241.9848, OV:6.5682, PN:748.5366
Epoch[3/5], Step[33], Loss:1000.2084
NE:0.3834, TC:85.7680, CC:315.2416, OV:5.3625, PN:593.4529
Epoch[3/5], Step[34], Loss:810.6780
NE:0.3647, TC:75.9790, CC:194.7531, OV:7.3917, PN:532.1895
Epoch[3/5], Step[35], Loss:998.2733
NE:0.3325, TC:75.5189, CC:383.8164, OV:3.2762, PN:535.3293
Epoch[3/5], Step[36], Loss:827.7855
NE:0.3897, TC:80.6583, CC:196.5444, OV:5.3973, PN:544.7958
Epoch[3/5], Step[37], Loss:773.3403
NE:0.3704, TC:75.3963, CC:191.4634, OV:5.8311, PN:500.2790
Epoch[3/5], Step[38], Loss:1032.2600
NE:0.3897, TC:78.5200, CC:241.3861, OV:4.9683, PN:706.9960
Epoch[3/5], Step[39], Loss:914.8679
NE:0.3151, TC:71.6484, CC:244.8735, OV:6.0256, PN:592.0053
Epoch[3/5], Step[40], Loss:1217.9919
NE:0.3833, TC:85.2919, CC:218.5420, OV:0.7143, PN:913.0604
Epoch[3/5], Step[41], Loss:1007.7942
NE:0.3512, TC:76.5173, CC:283.6703, OV:2.3704, PN:644.8850
Epoch[3/5], Step[42], Loss:775.8334
NE:0.3693, TC:76.7123, CC:194.6323, OV:5.7580, PN:498.3615
Epoch[3/5], Step[43], Loss:646.2777
NE:0.3943, TC:78.9221, CC:167.2731, OV:7.8632, PN:391.8251
Epoch[3/5], Step[44], Loss:868.0077
NE:0.3487, TC:73.9216, CC:204.8684, OV:5.7190, PN:583.1499
Epoch[3/5], Step[45], Loss:937.4799
NE:0.3004, TC:68.7494, CC:217.2355, OV:0.6873, PN:650.5073
Epoch[3/5], Step[46], Loss:920.9489
NE:0.2637, TC:61.9295, CC:364.1292, OV:0.2965, PN:494.3299
Epoch[3/5], Step[47], Loss:853.2180
NE:0.2548, TC:56.3568, CC:206.5894, OV:0.0007, PN:590.0165
Epoch[3/5], Step[48], Loss:910.7667
NE:0.3146, TC:69.7605, CC:292.6973, OV:6.4257, PN:541.5687
Epoch[3/5], Step[49], Loss:1058.8326
NE:0.3309, TC:73.8823, CC:399.5820, OV:2.8605, PN:582.1771
Epoch[3/5], Step[50], Loss:995.6707
NE:0.3320, TC:75.5489, CC:389.5594, OV:3.6016, PN:526.6287
Epoch[3/5], Step[51], Loss:1001.1497
NE:0.2933, TC:65.7916, CC:343.2804, OV:2.7959, PN:588.9885
Epoch[3/5], Step[52], Loss:632.5708
NE:0.3387, TC:69.0537, CC:180.2404, OV:6.1490, PN:376.7891
Epoch[3/5], Step[53], Loss:564.8921
NE:0.3746, TC:78.1398, CC:180.6763, OV:6.6476, PN:299.0539
Epoch[3/5], Step[54], Loss:865.5018
NE:0.2721, TC:65.3358, CC:268.6520, OV:2.3507, PN:528.8912
Epoch[3/5], Step[55], Loss:831.2557
NE:0.2564, TC:60.9499, CC:324.3295, OV:1.5291, PN:444.1909
Epoch[3/5], Step[56], Loss:910.1545
NE:0.3755, TC:80.0577, CC:195.6502, OV:8.2601, PN:625.8110
Epoch[3/5], Step[57], Loss:933.3329
NE:0.2557, TC:60.9881, CC:269.8874, OV:0.0239, PN:602.1777
Epoch[3/5], Step[58], Loss:1034.2654
NE:0.3101, TC:75.5694, CC:357.9542, OV:8.9041, PN:591.5276
Epoch[3/5], Step[59], Loss:920.9481
NE:0.3349, TC:69.0935, CC:217.4272, OV:4.5537, PN:629.5389
Epoch[3/5], Step[60], Loss:906.0569
NE:0.3086, TC:70.3737, CC:269.7188, OV:2.7616, PN:562.8942
2025-12-22 21:20:15,332 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_3_step_60.pth
Epoch[3/5], Step[61], Loss:844.6609
NE:0.3170, TC:68.6920, CC:242.5068, OV:7.7356, PN:525.4095
Epoch[3/5], Step[62], Loss:940.5834
NE:0.3138, TC:80.1819, CC:346.6215, OV:0.7136, PN:512.7527

Epoch = 4  lr = 3.782169276719e-06
Epoch[4/5], Step[0], Loss:1167.2009
NE:0.3288, TC:71.7598, CC:530.9179, OV:0.0479, PN:564.1466
2025-12-22 21:20:18,295 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_4_step_0.pth
Epoch[4/5], Step[1], Loss:636.7554
NE:0.3541, TC:75.1405, CC:185.3674, OV:7.8383, PN:368.0551
Epoch[4/5], Step[2], Loss:872.9911
NE:0.2801, TC:66.5161, CC:293.7565, OV:6.4011, PN:506.0373
Epoch[4/5], Step[3], Loss:1002.0082
NE:0.3690, TC:76.2593, CC:249.9423, OV:4.9567, PN:670.4808
Epoch[4/5], Step[4], Loss:897.0162
NE:0.2549, TC:60.1080, CC:269.4902, OV:1.1008, PN:566.0622
Epoch[4/5], Step[5], Loss:779.8950
NE:0.3747, TC:79.8016, CC:190.9137, OV:5.3885, PN:503.4164
Epoch[4/5], Step[6], Loss:706.7033
NE:0.2270, TC:52.1509, CC:192.0610, OV:0.6742, PN:461.5901
Epoch[4/5], Step[7], Loss:750.5665
NE:0.3498, TC:73.2090, CC:195.6701, OV:5.8207, PN:475.5170
Epoch[4/5], Step[8], Loss:885.5229
NE:0.3560, TC:77.8204, CC:173.8177, OV:7.0023, PN:626.5266
Epoch[4/5], Step[9], Loss:1074.0220
NE:0.3656, TC:86.7533, CC:300.4264, OV:7.7901, PN:678.6865
Epoch[4/5], Step[10], Loss:779.4776
NE:0.1894, TC:47.1985, CC:214.7332, OV:0.0167, PN:517.3397
Epoch[4/5], Step[11], Loss:743.8149
NE:0.2752, TC:61.3409, CC:238.7489, OV:3.6047, PN:439.8452
Epoch[4/5], Step[12], Loss:999.0848
NE:0.3117, TC:72.4850, CC:293.5472, OV:4.0223, PN:628.7185
Epoch[4/5], Step[13], Loss:578.0902
NE:0.3616, TC:78.5193, CC:195.8501, OV:7.4367, PN:295.9224
Epoch[4/5], Step[14], Loss:936.9692
NE:0.2656, TC:63.5782, CC:265.3280, OV:0.0239, PN:607.7736
Epoch[4/5], Step[15], Loss:976.2822
NE:0.2820, TC:64.6167, CC:345.8219, OV:2.7914, PN:562.7702
Epoch[4/5], Step[16], Loss:947.1619
NE:0.2888, TC:68.8293, CC:272.6339, OV:2.7683, PN:602.6417
Epoch[4/5], Step[17], Loss:953.7087
NE:0.3374, TC:83.0884, CC:331.5823, OV:0.7182, PN:537.9825
Epoch[4/5], Step[18], Loss:964.1963
NE:0.2534, TC:63.7520, CC:243.7583, OV:1.5320, PN:654.9008
Epoch[4/5], Step[19], Loss:796.1748
NE:0.2372, TC:58.0094, CC:299.8947, OV:0.6570, PN:437.3765
Epoch[4/5], Step[20], Loss:698.7678
NE:0.3537, TC:72.7524, CC:149.7364, OV:9.0406, PN:466.8846
Epoch[4/5], Step[21], Loss:747.2258
NE:0.3422, TC:71.4068, CC:191.5170, OV:5.3316, PN:478.6281
Epoch[4/5], Step[22], Loss:962.2092
NE:0.2624, TC:63.8303, CC:369.9257, OV:1.5306, PN:526.6602
Epoch[4/5], Step[23], Loss:999.7603
NE:0.3793, TC:83.0636, CC:216.0416, OV:6.6202, PN:693.6556
Epoch[4/5], Step[24], Loss:868.2598
NE:0.3339, TC:69.5779, CC:242.7319, OV:7.7424, PN:547.8737
Epoch[4/5], Step[25], Loss:961.1678
NE:0.3216, TC:76.7631, CC:324.5190, OV:2.8431, PN:556.7210
Epoch[4/5], Step[26], Loss:866.2515
NE:0.3491, TC:71.2212, CC:182.7257, OV:4.5676, PN:607.3879
Epoch[4/5], Step[27], Loss:942.4368
NE:0.3304, TC:74.5183, CC:346.4219, OV:3.2754, PN:517.8908
Epoch[4/5], Step[28], Loss:867.1944
NE:0.3559, TC:78.2044, CC:231.1256, OV:7.3878, PN:550.1207
Epoch[4/5], Step[29], Loss:624.3929
NE:0.3600, TC:73.3859, CC:173.5947, OV:7.4313, PN:369.6211
Epoch[4/5], Step[30], Loss:956.4155
NE:0.3618, TC:86.3111, CC:288.8402, OV:5.3674, PN:575.5349
Epoch[4/5], Step[31], Loss:1057.8085
NE:0.2852, TC:64.9904, CC:238.8665, OV:1.5393, PN:752.1271
Epoch[4/5], Step[32], Loss:834.1321
NE:0.2557, TC:58.7338, CC:320.7149, OV:1.5238, PN:452.9039
Epoch[4/5], Step[33], Loss:552.2113
NE:0.3729, TC:77.6666, CC:173.3806, OV:6.6468, PN:294.1443
Epoch[4/5], Step[34], Loss:737.3580
NE:0.3598, TC:78.3783, CC:176.3710, OV:8.2542, PN:473.9947
Epoch[4/5], Step[35], Loss:775.8315
NE:0.3019, TC:71.1486, CC:272.7930, OV:0.7214, PN:430.8667
Epoch[4/5], Step[36], Loss:870.7448
NE:0.2695, TC:65.1849, CC:274.6655, OV:2.3509, PN:528.2740
Epoch[4/5], Step[37], Loss:956.8411
NE:0.3073, TC:73.0350, CC:397.4727, OV:3.5904, PN:482.4356
Epoch[4/5], Step[38], Loss:1032.9221
NE:0.3367, TC:75.9690, CC:237.8136, OV:6.5525, PN:712.2503
Epoch[4/5], Step[39], Loss:897.1371
NE:0.3924, TC:81.3445, CC:178.6665, OV:8.2663, PN:628.4675
Epoch[4/5], Step[40], Loss:902.1246
NE:0.3239, TC:75.4518, CC:245.3052, OV:2.3708, PN:578.6730
Epoch[4/5], Step[41], Loss:1030.7534
NE:0.3295, TC:74.1643, CC:275.3387, OV:1.9727, PN:678.9482
Epoch[4/5], Step[42], Loss:755.2458
NE:0.2439, TC:55.1735, CC:208.8769, OV:2.3188, PN:488.6327
Epoch[4/5], Step[43], Loss:1023.7011
NE:0.3379, TC:75.7612, CC:364.1541, OV:2.8690, PN:580.5789
Epoch[4/5], Step[44], Loss:607.1977
NE:0.3916, TC:80.6271, CC:163.8443, OV:9.0836, PN:353.2512
Epoch[4/5], Step[45], Loss:862.9398
NE:0.3153, TC:71.0223, CC:267.1248, OV:6.0736, PN:518.4038
Epoch[4/5], Step[46], Loss:761.0769
NE:0.3751, TC:75.9189, CC:181.8954, OV:5.7544, PN:497.1331
Epoch[4/5], Step[47], Loss:825.1193
NE:0.3449, TC:72.8246, CC:180.1491, OV:5.7145, PN:566.0862
Epoch[4/5], Step[48], Loss:530.7600
NE:0.1137, TC:39.2268, CC:223.3622, OV:0.0007, PN:268.0567
Epoch[4/5], Step[49], Loss:1103.8496
NE:0.3129, TC:73.8054, CC:271.9777, OV:0.7052, PN:757.0483
Epoch[4/5], Step[50], Loss:927.6990
NE:0.3813, TC:81.6149, CC:174.3762, OV:9.0227, PN:662.3038
Epoch[4/5], Step[51], Loss:802.1279
NE:0.3924, TC:76.7603, CC:167.4209, OV:6.2498, PN:551.3044
Epoch[4/5], Step[52], Loss:688.8917
NE:0.3952, TC:80.8829, CC:153.3238, OV:9.0443, PN:445.2456
Epoch[4/5], Step[53], Loss:604.3596
NE:0.3488, TC:69.4559, CC:157.9052, OV:6.1512, PN:370.4986
Epoch[4/5], Step[54], Loss:860.6190
NE:0.3974, TC:84.9827, CC:189.0622, OV:9.0577, PN:577.1189
Epoch[4/5], Step[55], Loss:696.9469
NE:0.2254, TC:53.9552, CC:246.3628, OV:1.4830, PN:394.9206
Epoch[4/5], Step[56], Loss:1039.8834
NE:0.3222, TC:74.6711, CC:357.4183, OV:8.8983, PN:598.5735
Epoch[4/5], Step[57], Loss:894.5898
NE:0.3133, TC:71.8742, CC:251.5342, OV:2.7674, PN:568.1007
Epoch[4/5], Step[58], Loss:897.3068
NE:0.3133, TC:70.4636, CC:228.4725, OV:6.0165, PN:592.0410
Epoch[4/5], Step[59], Loss:881.1083
NE:0.2883, TC:65.4646, CC:286.9241, OV:0.3010, PN:528.1302
Epoch[4/5], Step[60], Loss:797.7921
NE:0.2501, TC:57.5783, CC:174.3345, OV:0.6717, PN:564.9575
2025-12-22 21:21:20,774 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_4_step_60.pth
Epoch[4/5], Step[61], Loss:1168.7614
NE:0.3607, TC:82.7784, CC:231.2270, OV:0.7089, PN:853.6863
Epoch[4/5], Step[62], Loss:772.6688
NE:0.3668, TC:74.8174, CC:169.5998, OV:7.3846, PN:520.5002

Epoch = 5  lr = 1.4071692767190003e-06
Epoch[5/5], Step[0], Loss:1086.0793
NE:0.3156, TC:74.7051, CC:248.5695, OV:0.7068, PN:761.7824
2025-12-22 21:21:24,547 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_5_step_0.pth
Epoch[5/5], Step[1], Loss:840.2004
NE:0.3504, TC:70.6014, CC:209.3817, OV:7.7469, PN:552.1201
Epoch[5/5], Step[2], Loss:588.9753
NE:0.3898, TC:79.0923, CC:156.0829, OV:9.0728, PN:344.3375
Epoch[5/5], Step[3], Loss:1047.5908
NE:0.3539, TC:77.1963, CC:213.9548, OV:6.5616, PN:749.5243
Epoch[5/5], Step[4], Loss:979.8002
NE:0.3846, TC:86.8681, CC:271.3019, OV:5.3716, PN:615.8738
Epoch[5/5], Step[5], Loss:990.2960
NE:0.3915, TC:78.7341, CC:212.1556, OV:4.9712, PN:694.0435
Epoch[5/5], Step[6], Loss:1026.1680
NE:0.3282, TC:75.9366, CC:330.7125, OV:8.9106, PN:610.2800
Epoch[5/5], Step[7], Loss:754.8783
NE:0.3758, TC:75.5834, CC:172.0623, OV:5.7517, PN:501.1050
Epoch[5/5], Step[8], Loss:807.4994
NE:0.2402, TC:57.8833, CC:290.6122, OV:0.6568, PN:458.1069
Epoch[5/5], Step[9], Loss:917.0092
NE:0.2748, TC:60.3975, CC:250.0315, OV:1.1024, PN:605.2030
Epoch[5/5], Step[10], Loss:972.4349
NE:0.3483, TC:76.1699, CC:338.9262, OV:3.2817, PN:553.7087
Epoch[5/5], Step[11], Loss:893.2881
NE:0.3106, TC:70.6454, CC:236.4183, OV:6.0164, PN:579.8975
Epoch[5/5], Step[12], Loss:809.5198
NE:0.3585, TC:73.8427, CC:159.0007, OV:5.7226, PN:570.5952
Epoch[5/5], Step[13], Loss:931.5834
NE:0.2830, TC:67.9077, CC:303.6005, OV:1.5417, PN:558.2504
Epoch[5/5], Step[14], Loss:856.7113
NE:0.2631, TC:64.3670, CC:195.5700, OV:0.0239, PN:596.4874
Epoch[5/5], Step[15], Loss:962.7867
NE:0.3169, TC:72.2319, CC:269.5974, OV:4.0215, PN:616.6189
Epoch[5/5], Step[16], Loss:1154.6416
NE:0.3792, TC:86.0099, CC:177.7203, OV:0.7155, PN:889.8168
Epoch[5/5], Step[17], Loss:781.3671
NE:0.2471, TC:57.3658, CC:167.9417, OV:0.6714, PN:555.1411
Epoch[5/5], Step[18], Loss:704.8211
NE:0.2828, TC:63.2754, CC:201.4452, OV:3.6159, PN:436.2018
Epoch[5/5], Step[19], Loss:864.9711
NE:0.2804, TC:66.1517, CC:288.0941, OV:6.4017, PN:504.0432
Epoch[5/5], Step[20], Loss:1068.6875
NE:0.2956, TC:65.2356, CC:230.7775, OV:1.5365, PN:770.8422
Epoch[5/5], Step[21], Loss:530.8274
NE:0.3920, TC:79.9281, CC:166.2960, OV:7.4508, PN:276.7605
Epoch[5/5], Step[22], Loss:1058.4071
NE:0.3394, TC:74.3483, CC:375.0533, OV:2.8634, PN:605.8027
Epoch[5/5], Step[23], Loss:1050.7390
NE:0.3142, TC:78.1967, CC:390.6933, OV:0.7098, PN:580.8251
Epoch[5/5], Step[24], Loss:914.9429
NE:0.3827, TC:81.3815, CC:167.7776, OV:9.0222, PN:656.3789
Epoch[5/5], Step[25], Loss:726.7067
NE:0.3735, TC:77.9840, CC:168.7489, OV:8.2492, PN:471.3510
Epoch[5/5], Step[26], Loss:817.1787
NE:0.3744, TC:75.1117, CC:175.7834, OV:6.2424, PN:559.6668
Epoch[5/5], Step[27], Loss:924.5930
NE:0.3160, TC:73.0123, CC:201.8341, OV:2.7846, PN:646.6460
Epoch[5/5], Step[28], Loss:878.9420
NE:0.2717, TC:64.8768, CC:278.8782, OV:2.3492, PN:532.5660
Epoch[5/5], Step[29], Loss:995.2233
NE:0.3350, TC:75.2513, CC:240.0116, OV:1.9759, PN:677.6495
Epoch[5/5], Step[30], Loss:749.7675
NE:0.3524, TC:71.5316, CC:171.7530, OV:5.3320, PN:500.7985
Epoch[5/5], Step[31], Loss:718.5422
NE:0.2485, TC:56.2263, CC:234.9330, OV:1.4888, PN:425.6458
Epoch[5/5], Step[32], Loss:774.0615
NE:0.2139, TC:49.9241, CC:161.6136, OV:0.0167, PN:562.2932
Epoch[5/5], Step[33], Loss:676.6730
NE:0.3634, TC:72.5324, CC:137.7593, OV:9.0415, PN:456.9765
Epoch[5/5], Step[34], Loss:531.9197
NE:0.3824, TC:78.1445, CC:162.0171, OV:6.6514, PN:284.7243
Epoch[5/5], Step[35], Loss:623.1512
NE:0.3697, TC:74.6755, CC:164.0893, OV:7.4374, PN:376.5793
Epoch[5/5], Step[36], Loss:709.9323
NE:0.3795, TC:79.5730, CC:161.6382, OV:9.0325, PN:459.3090
Epoch[5/5], Step[37], Loss:972.8914
NE:0.3644, TC:81.3518, CC:231.5597, OV:6.6092, PN:653.0063
Epoch[5/5], Step[38], Loss:929.4834
NE:0.3202, TC:75.3613, CC:349.5252, OV:3.6004, PN:500.6763
Epoch[5/5], Step[39], Loss:768.9613
NE:0.3648, TC:74.6747, CC:173.9919, OV:7.3857, PN:512.5443
Epoch[5/5], Step[40], Loss:869.0529
NE:0.3763, TC:78.5288, CC:151.0061, OV:7.0056, PN:632.1360
Epoch[5/5], Step[41], Loss:1198.9008
NE:0.2774, TC:66.0145, CC:621.9230, OV:0.0478, PN:510.6380
Epoch[5/5], Step[42], Loss:628.7390
NE:0.1755, TC:47.7324, CC:173.0455, OV:0.0007, PN:407.7850
Epoch[5/5], Step[43], Loss:895.6222
NE:0.3948, TC:81.1000, CC:167.0090, OV:8.2655, PN:638.8529
Epoch[5/5], Step[44], Loss:742.9493
NE:0.2423, TC:54.9336, CC:201.7930, OV:2.3167, PN:483.6638
Epoch[5/5], Step[45], Loss:1042.0024
NE:0.2655, TC:61.3323, CC:255.6379, OV:1.5233, PN:723.2433
Epoch[5/5], Step[46], Loss:1094.2612
NE:0.3680, TC:84.7726, CC:307.4240, OV:7.7786, PN:693.9180
Epoch[5/5], Step[47], Loss:910.0491
NE:0.3541, TC:70.5545, CC:184.7059, OV:4.5630, PN:649.8715
Epoch[5/5], Step[48], Loss:764.2878
NE:0.2653, TC:56.2844, CC:159.2896, OV:0.6814, PN:547.7672
Epoch[5/5], Step[49], Loss:866.8857
NE:0.3647, TC:77.7576, CC:218.5683, OV:7.3884, PN:562.8067
Epoch[5/5], Step[50], Loss:823.2750
NE:0.3167, TC:72.5392, CC:285.6765, OV:0.7232, PN:464.0195
Epoch[5/5], Step[51], Loss:875.4158
NE:0.2987, TC:70.1781, CC:253.3193, OV:2.7600, PN:548.8597
Epoch[5/5], Step[52], Loss:615.1895
NE:0.3492, TC:69.1094, CC:158.4730, OV:6.1454, PN:381.1125
Epoch[5/5], Step[53], Loss:833.7435
NE:0.3077, TC:69.6724, CC:250.2966, OV:6.0622, PN:507.4045
Epoch[5/5], Step[54], Loss:946.0242
NE:0.3254, TC:76.3837, CC:316.3949, OV:2.8433, PN:550.0769
Epoch[5/5], Step[55], Loss:729.0599
NE:0.3670, TC:74.0735, CC:165.6968, OV:5.8281, PN:483.0945
Epoch[5/5], Step[56], Loss:751.4030
NE:0.3894, TC:78.7874, CC:170.7081, OV:5.3839, PN:496.1342
Epoch[5/5], Step[57], Loss:843.1213
NE:0.2776, TC:64.1780, CC:279.6769, OV:0.2992, PN:498.6896
Epoch[5/5], Step[58], Loss:609.1931
NE:0.3686, TC:75.6438, CC:159.3204, OV:7.8413, PN:366.0190
Epoch[5/5], Step[59], Loss:903.6760
NE:0.3307, TC:74.3189, CC:236.0840, OV:2.3662, PN:590.5764
Epoch[5/5], Step[60], Loss:944.9802
NE:0.2782, TC:63.4088, CC:321.1666, OV:2.7881, PN:557.3385
2025-12-22 21:22:25,682 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_5_step_60.pth
Epoch[5/5], Step[61], Loss:797.4926
NE:0.2580, TC:58.5999, CC:291.9227, OV:1.5242, PN:445.1877
Epoch[5/5], Step[62], Loss:821.0444
NE:0.3758, TC:81.6302, CC:190.8463, OV:9.0312, PN:539.1610
2025-12-22 21:22:27,920 INFO Training finished

### Predict ###

2025-12-22 21:22:27,925 INFO Initialising model
Number of genes: 313
2025-12-22 21:22:28,653 INFO Preparing data
Loaded nuclei
(382, 510)
88 patches available
Cell types: ['B', 'CD4Tconv/Treg', 'CD8T/CD8Tex', 'DC', 'Endothelial', 'Epithelial', 'Fibroblasts', 'Malignant', 'Mast', 'Mono/Macro', 'Myofibroblasts', 'NK', 'Neutrophils', 'Plasma', 'SMC']
2025-12-22 21:22:28,686 INFO Total number of patches: 88
2025-12-22 21:22:28,686 INFO Begin prediction
Predict using D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_1_step_60.pth
2025-12-22 21:23:32,948 INFO Preparing data
Loaded nuclei
(382, 510)
70 patches available
Cell types: ['B', 'CD4Tconv/Treg', 'CD8T/CD8Tex', 'DC', 'Endothelial', 'Epithelial', 'Fibroblasts', 'Malignant', 'Mast', 'Mono/Macro', 'Myofibroblasts', 'NK', 'Neutrophils', 'Plasma', 'SMC']
2025-12-22 21:23:32,980 INFO Total number of patches: 70
2025-12-22 21:23:32,980 INFO Begin prediction
Predict using D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\model_outputs\2025_12_22_21_16_56/models/epoch_1_step_60.pth
2025-12-22 21:24:21,842 INFO Finished
Combining predictions
2 patches available
Num multiprocessing splits: 8
Processing...
Combining results
Saved segmentation to D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small/model_outputs/2025_12_22_21_16_56/test_output/epoch_1_step_60_connected.tif
Number of cells 852
Number of splits for multiprocessing: 8
Segmentation map pixel size:  (1798, 2400)
Saving temporary resized segmentation
Extracting cell expressions
Patch H 0:1798, W 0:2400
(1798, 2400)
Reading filtered transcripts
0.0 508.99520000000007 0.0 380.99484
Transforming x_location
Transforming y_location
0 2395 0 1793
Transforming x_location
Transforming y_location
0 2395 0 1793
Extracting cell-gene matrix chunks
Combining cell-gene matrix chunks
Obtained cell-gene matrix
Done

### Done ###
