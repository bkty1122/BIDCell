### Preprocessing ###

Reading DAPI image
D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\morphology_mip_small.tif
DAPI shape h: 1800 w: 2400
Segmenting DAPI patches h: 1800 w: 2400
Nuclei image h: 382 w: 510
Finished segmenting, found 852 nuclei
Loading transcripts file
   Unnamed: 0    transcript_id  cell_id  ...  y_location z_location         qv
0     2565587  281496451551924       -1  ...   469.34515  10.958567  40.000000
1     2565590  281496451551927    44769  ...   327.25198  15.099401  40.000000
2     2565591  281496451551928    45392  ...   577.32130  11.937755  20.782797
3     2565592  281496451551929    46672  ...   365.75200  10.617414  40.000000
4     2565595  281496451551932       -1  ...   409.68720  11.384081  40.000000

[5 rows x 9 columns]
Filtering transcripts
Finished filtering
Saving csv...
<bound method NDFrame.head of         Unnamed: 0    transcript_id  cell_id  ...  y_location z_location         qv
0          2565587  281496451551924       -1  ...         257  10.958567  40.000000
1          2565590  281496451551927    44769  ...         115  15.099401  40.000000
2          2565591  281496451551928    45392  ...         365  11.937755  20.782797
3          2565592  281496451551929    46672  ...         154  10.617414  40.000000
4          2565595  281496451551932       -1  ...         198  11.384081  40.000000
...            ...              ...      ...  ...         ...        ...        ...
186141     3940032  281500747163393    43575  ...         243  16.281252  35.923073
186142     3940037  281500747163399    43517  ...           2  15.730230  40.000000
186143     3940039  281500747163401    43534  ...          37  15.751373  27.767600
186144     3940041  281500747163403    43543  ...         299  12.549458  40.000000
186145     3940042  281500747163404    43530  ...          26  17.624292  28.487734

[186146 rows x 9 columns]>
(186146, 9)
313 unique genes
Total height 382, width 510
Converting to maps
Patch: (0, 382, 0, 510)
Saved all maps
(382, 510)
Processing D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\expr_maps\all_genes_0_382_0_510.hdf5
Loaded gene expr maps from D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\expr_maps\all_genes_0_382_0_510.hdf5
[0, 382, 0, 510]
Shift by 0
88 patches
Shift by 24
70 patches
Number of cells 852
Number of splits for multiprocessing: 8
Segmentation map pixel size:  (1798, 2400)
Saving temporary resized segmentation
Extracting cell expressions
Patch H 0:1798, W 0:2400
(1798, 2400)
Reading filtered transcripts
0.0 508.99520000000007 0.0 380.99484
Transforming x_location
Transforming y_location
0 2395 0 1793
Transforming x_location
Transforming y_location
0 2395 0 1793
Extracting cell-gene matrix chunks
Combining cell-gene matrix chunks
Obtained cell-gene matrix
Done
Number of cells: 852
Number of splits for multiprocessing: 8
Computing simple annotation

### Training ###

Using device: cuda
2026-01-12 21:11:30,557 INFO Initialising model
Number of genes: 313
2026-01-12 21:11:31,296 INFO Preparing data
Loaded nuclei
(382, 510)
63 patches available
Cell types: ['B', 'CD4Tconv/Treg', 'CD8T/CD8Tex', 'DC', 'Endothelial', 'Epithelial', 'Fibroblasts', 'Malignant', 'Mast', 'Mono/Macro', 'Myofibroblasts', 'NK', 'Neutrophils', 'Plasma', 'SMC']
2026-01-12 21:11:31,328 INFO Total number of training examples: 63
2026-01-12 21:11:31,330 INFO Begin training

Epoch = 1  lr = 1e-05
Epoch[1/5], Step[0], Loss:2862.0776
NE:0.5179, TC:190.5490, CC:1385.1545, OV:8.4645, PN:1277.3918
2026-01-12 21:11:33,918 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_1_step_0.pth
Epoch[1/5], Step[1], Loss:2432.6025
NE:0.5095, TC:186.7450, CC:1103.6145, OV:1.8037, PN:1139.9299
Epoch[1/5], Step[2], Loss:2347.2544
NE:0.5187, TC:179.7108, CC:1039.8313, OV:0.8763, PN:1126.3171
Epoch[1/5], Step[3], Loss:2060.0574
NE:0.5321, TC:171.6246, CC:823.5935, OV:6.6645, PN:1057.6426
Epoch[1/5], Step[4], Loss:1931.9884
NE:0.5406, TC:164.4133, CC:743.1853, OV:5.7554, PN:1018.0939
Epoch[1/5], Step[5], Loss:1988.5894
NE:0.5764, TC:163.5811, CC:716.4005, OV:6.1710, PN:1101.8602
Epoch[1/5], Step[6], Loss:1902.3459
NE:0.5360, TC:150.0495, CC:694.3492, OV:0.0538, PN:1057.3574
Epoch[1/5], Step[7], Loss:1910.4457
NE:0.6155, TC:163.5130, CC:647.5794, OV:3.9670, PN:1094.7708
Epoch[1/5], Step[8], Loss:1687.3013
NE:0.6347, TC:152.2916, CC:552.7090, OV:9.4903, PN:972.1757
Epoch[1/5], Step[9], Loss:1958.1143
NE:0.5741, TC:144.6221, CC:598.4117, OV:2.5988, PN:1211.9076
Epoch[1/5], Step[10], Loss:1778.7118
NE:0.6553, TC:151.2840, CC:527.1941, OV:7.8265, PN:1091.7518
Epoch[1/5], Step[11], Loss:1573.7524
NE:0.5988, TC:141.0583, CC:500.9969, OV:3.9168, PN:927.1815
Epoch[1/5], Step[12], Loss:1783.8501
NE:0.6358, TC:147.9737, CC:485.6582, OV:3.0814, PN:1146.5011
Epoch[1/5], Step[13], Loss:1770.7360
NE:0.5994, TC:142.5439, CC:483.8336, OV:3.0200, PN:1140.7390
Epoch[1/5], Step[14], Loss:1796.2830
NE:0.5946, TC:136.7659, CC:482.9645, OV:0.7911, PN:1175.1669
Epoch[1/5], Step[15], Loss:1459.5281
NE:0.6029, TC:131.7709, CC:416.9193, OV:6.0769, PN:904.1581
Epoch[1/5], Step[16], Loss:1589.0291
NE:0.5821, TC:131.1230, CC:451.4109, OV:8.1175, PN:997.7956
Epoch[1/5], Step[17], Loss:1559.0457
NE:0.5884, TC:132.1919, CC:412.6139, OV:8.5198, PN:1005.1315
Epoch[1/5], Step[18], Loss:1107.3276
NE:0.5604, TC:129.4493, CC:409.1483, OV:6.9000, PN:561.2696
Epoch[1/5], Step[19], Loss:1929.6205
NE:0.4768, TC:125.2183, CC:534.8192, OV:1.6776, PN:1267.4286
Epoch[1/5], Step[20], Loss:1758.0947
NE:0.5528, TC:129.3227, CC:433.1219, OV:6.8625, PN:1188.2349
Epoch[1/5], Step[21], Loss:1579.1399
NE:0.4831, TC:123.3226, CC:545.3249, OV:3.0208, PN:906.9885
Epoch[1/5], Step[22], Loss:1593.9521
NE:0.4480, TC:115.1817, CC:600.0908, OV:1.6507, PN:876.5809
Epoch[1/5], Step[23], Loss:1671.2549
NE:0.4324, TC:120.0297, CC:537.5872, OV:0.0269, PN:1013.1788
Epoch[1/5], Step[24], Loss:1480.9167
NE:0.4774, TC:125.7402, CC:542.6612, OV:5.5695, PN:806.4684
Epoch[1/5], Step[25], Loss:1412.9480
NE:0.4182, TC:112.4931, CC:464.9078, OV:4.7199, PN:830.4091
Epoch[1/5], Step[26], Loss:1474.2446
NE:0.4378, TC:117.8427, CC:511.5376, OV:2.5043, PN:841.9222
Epoch[1/5], Step[27], Loss:1442.4679
NE:0.3811, TC:108.6667, CC:447.8978, OV:0.7560, PN:884.7663
Epoch[1/5], Step[28], Loss:1193.0764
NE:0.4305, TC:115.0903, CC:423.7840, OV:9.2611, PN:644.5104
Epoch[1/5], Step[29], Loss:1403.0984
NE:0.3991, TC:110.6190, CC:510.9509, OV:6.2463, PN:774.8831
Epoch[1/5], Step[30], Loss:1430.2285
NE:0.3677, TC:104.6432, CC:505.4916, OV:1.1886, PN:818.5373
Epoch[1/5], Step[31], Loss:1393.4062
NE:0.4105, TC:106.6183, CC:461.9895, OV:5.0785, PN:819.3094
Epoch[1/5], Step[32], Loss:1445.0432
NE:0.3664, TC:106.2447, CC:533.9020, OV:2.8990, PN:801.6309
Epoch[1/5], Step[33], Loss:1111.4988
NE:0.3871, TC:105.9759, CC:463.3296, OV:7.5729, PN:534.2333
Epoch[1/5], Step[34], Loss:1198.4861
NE:0.3732, TC:103.4585, CC:455.1390, OV:5.4928, PN:634.0226
Epoch[1/5], Step[35], Loss:1411.3591
NE:0.3278, TC:102.6929, CC:485.7712, OV:0.0178, PN:822.5494
Epoch[1/5], Step[36], Loss:1562.3054
NE:0.3668, TC:101.8351, CC:575.5319, OV:0.7503, PN:883.8214
Epoch[1/5], Step[37], Loss:1022.5818
NE:0.3936, TC:102.1989, CC:381.4630, OV:9.1952, PN:529.3311
Epoch[1/5], Step[38], Loss:1155.1417
NE:0.3921, TC:100.1964, CC:385.7568, OV:7.5240, PN:661.2724
Epoch[1/5], Step[39], Loss:1485.4700
NE:0.3303, TC:93.6540, CC:515.4707, OV:1.6086, PN:874.4064
Epoch[1/5], Step[40], Loss:1243.3231
NE:0.3911, TC:104.3827, CC:384.4259, OV:9.1728, PN:744.9506
Epoch[1/5], Step[41], Loss:1145.5295
NE:0.3690, TC:98.8997, CC:499.0393, OV:0.7645, PN:546.4571
Epoch[1/5], Step[42], Loss:1185.8628
NE:0.3135, TC:86.9489, CC:513.9019, OV:0.3275, PN:584.3710
Epoch[1/5], Step[43], Loss:1266.7164
NE:0.3459, TC:96.9056, CC:448.2010, OV:2.0328, PN:719.2312
Epoch[1/5], Step[44], Loss:952.8011
NE:0.3828, TC:95.3144, CC:354.5488, OV:7.9341, PN:494.6210
Epoch[1/5], Step[45], Loss:1278.0774
NE:0.3419, TC:95.7647, CC:450.9987, OV:4.1227, PN:726.8492
Epoch[1/5], Step[46], Loss:1047.1318
NE:0.3783, TC:96.1227, CC:357.3150, OV:8.3496, PN:584.9662
Epoch[1/5], Step[47], Loss:971.7255
NE:0.3839, TC:93.6041, CC:336.3644, OV:7.5370, PN:533.8361
Epoch[1/5], Step[48], Loss:1158.8246
NE:0.3834, TC:93.6753, CC:342.9804, OV:7.0829, PN:714.7026
Epoch[1/5], Step[49], Loss:1079.4890
NE:0.3825, TC:97.0114, CC:358.5064, OV:9.1199, PN:614.4688
Epoch[1/5], Step[50], Loss:1223.6357
NE:0.3406, TC:89.8681, CC:518.5483, OV:3.3215, PN:611.5573
Epoch[1/5], Step[51], Loss:1100.8214
NE:0.3279, TC:80.5231, CC:332.9176, OV:0.7212, PN:686.3315
Epoch[1/5], Step[52], Loss:1160.0378
NE:0.3214, TC:88.0848, CC:469.7777, OV:6.5423, PN:595.3116
Epoch[1/5], Step[53], Loss:1142.9905
NE:0.3241, TC:89.4239, CC:404.2986, OV:2.4265, PN:646.5174
Epoch[1/5], Step[54], Loss:1162.9620
NE:0.3003, TC:83.8812, CC:500.1328, OV:1.5814, PN:577.0663
Epoch[1/5], Step[55], Loss:877.5623
NE:0.3476, TC:83.6170, CC:306.3703, OV:6.2193, PN:481.0082
Epoch[1/5], Step[56], Loss:1032.2676
NE:0.3639, TC:86.7803, CC:321.9756, OV:6.2891, PN:616.8586
Epoch[1/5], Step[57], Loss:976.9636
NE:0.3483, TC:86.1399, CC:344.2859, OV:5.7972, PN:540.3922
Epoch[1/5], Step[58], Loss:1173.0082
NE:0.3643, TC:92.6772, CC:396.9644, OV:6.6592, PN:676.3430
Epoch[1/5], Step[59], Loss:1309.2024
NE:0.3594, TC:94.0764, CC:360.5836, OV:0.7277, PN:853.4553
Epoch[1/5], Step[60], Loss:1173.7058
NE:0.2981, TC:78.9092, CC:473.6111, OV:2.8382, PN:618.0492
2026-01-12 21:15:45,072 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_1_step_60.pth
Epoch[1/5], Step[61], Loss:1035.2028
NE:0.2737, TC:80.3049, CC:315.1027, OV:0.0007, PN:639.5208
Epoch[1/5], Step[62], Loss:1237.8386
NE:0.3095, TC:85.4360, CC:524.2326, OV:8.9653, PN:618.8951

Epoch = 2  lr = 9.092830723281e-06
Epoch[2/5], Step[0], Loss:1090.7140
NE:0.2698, TC:73.6618, CC:403.3446, OV:1.1270, PN:612.3109
2026-01-12 21:16:12,845 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_2_step_0.pth
Epoch[2/5], Step[1], Loss:1211.9646
NE:0.3205, TC:87.3171, CC:547.0479, OV:3.6481, PN:573.6310
Epoch[2/5], Step[2], Loss:1290.8843
NE:0.3322, TC:89.8727, CC:376.3121, OV:0.7206, PN:823.6467
Epoch[2/5], Step[3], Loss:1205.1237
NE:0.2596, TC:73.6676, CC:444.8317, OV:1.5597, PN:684.8051
Epoch[2/5], Step[4], Loss:1211.8972
NE:0.2837, TC:80.8440, CC:460.5599, OV:0.7135, PN:669.4960
Epoch[2/5], Step[5], Loss:871.9683
NE:0.3094, TC:78.9543, CC:333.6385, OV:7.4436, PN:451.6225
Epoch[2/5], Step[6], Loss:1002.6533
NE:0.3111, TC:84.2784, CC:378.2958, OV:9.0456, PN:530.7225
Epoch[2/5], Step[7], Loss:1106.8157
NE:0.2789, TC:80.1265, CC:434.4756, OV:1.9853, PN:589.9494
Epoch[2/5], Step[8], Loss:1117.4806
NE:0.3094, TC:83.9127, CC:419.1182, OV:6.6098, PN:607.5306
Epoch[2/5], Step[9], Loss:861.0877
NE:0.3080, TC:81.0309, CC:335.4639, OV:9.0710, PN:435.2138
Epoch[2/5], Step[10], Loss:1152.1248
NE:0.2917, TC:82.9432, CC:516.0750, OV:5.3403, PN:547.4747
Epoch[2/5], Step[11], Loss:1052.1191
NE:0.2622, TC:75.1790, CC:410.3321, OV:2.7883, PN:563.5575
Epoch[2/5], Step[12], Loss:1092.0541
NE:0.2990, TC:82.3939, CC:458.3784, OV:2.8601, PN:548.1227
Epoch[2/5], Step[13], Loss:981.5151
NE:0.2879, TC:74.8719, CC:347.6145, OV:5.7314, PN:553.0095
Epoch[2/5], Step[14], Loss:762.5758
NE:0.1553, TC:59.9648, CC:340.4410, OV:0.0007, PN:362.0141
Epoch[2/5], Step[15], Loss:758.5222
NE:0.3380, TC:83.4958, CC:306.7200, OV:7.4619, PN:360.5064
Epoch[2/5], Step[16], Loss:1055.0662
NE:0.2923, TC:74.6180, CC:392.0035, OV:2.3794, PN:585.7729
Epoch[2/5], Step[17], Loss:972.2871
NE:0.3514, TC:84.3670, CC:317.8660, OV:7.4249, PN:562.2778
Epoch[2/5], Step[18], Loss:876.3574
NE:0.3590, TC:82.8822, CC:303.9357, OV:5.3931, PN:483.7874
Epoch[2/5], Step[19], Loss:1054.3036
NE:0.3009, TC:78.1835, CC:309.6570, OV:0.7027, PN:665.4596
Epoch[2/5], Step[20], Loss:1025.3290
NE:0.3304, TC:81.5670, CC:406.1950, OV:3.2975, PN:533.9390
Epoch[2/5], Step[21], Loss:764.6865
NE:0.3323, TC:76.1026, CC:255.5219, OV:6.1765, PN:426.5533
Epoch[2/5], Step[22], Loss:1147.5417
NE:0.3504, TC:84.0167, CC:315.2527, OV:6.5861, PN:741.3358
Epoch[2/5], Step[23], Loss:1088.2059
NE:0.3680, TC:82.1049, CC:309.6903, OV:4.9807, PN:691.0620
Epoch[2/5], Step[24], Loss:1114.5089
NE:0.3520, TC:82.1113, CC:371.8977, OV:2.3875, PN:657.7604
Epoch[2/5], Step[25], Loss:963.9866
NE:0.2836, TC:70.6058, CC:335.1061, OV:1.5228, PN:556.4683
Epoch[2/5], Step[26], Loss:1006.6259
NE:0.2888, TC:74.1188, CC:405.7502, OV:6.4526, PN:520.0154
Epoch[2/5], Step[27], Loss:935.7289
NE:0.3022, TC:76.4046, CC:395.3375, OV:0.7290, PN:462.9557
Epoch[2/5], Step[28], Loss:950.4184
NE:0.3338, TC:79.7099, CC:266.4741, OV:7.0052, PN:596.8954
Epoch[2/5], Step[29], Loss:1002.0919
NE:0.2842, TC:75.0905, CC:352.5801, OV:6.0503, PN:568.0868
Epoch[2/5], Step[30], Loss:876.2328
NE:0.2435, TC:63.6547, CC:324.1719, OV:2.3410, PN:485.8217
Epoch[2/5], Step[31], Loss:1006.0773
NE:0.2573, TC:69.1172, CC:329.1878, OV:0.0240, PN:607.4911
Epoch[2/5], Step[32], Loss:860.3837
NE:0.3062, TC:73.5014, CC:296.1749, OV:5.8093, PN:484.5918
Epoch[2/5], Step[33], Loss:878.9962
NE:0.3018, TC:76.3812, CC:305.0360, OV:8.2203, PN:489.0568
Epoch[2/5], Step[34], Loss:1032.8457
NE:0.2443, TC:65.8337, CC:458.6841, OV:2.7934, PN:505.2902
Epoch[2/5], Step[35], Loss:882.0065
NE:0.2468, TC:62.8263, CC:397.3453, OV:0.2970, PN:421.2913
Epoch[2/5], Step[36], Loss:1083.5386
NE:0.2255, TC:62.6019, CC:555.0916, OV:1.5245, PN:464.0951
Epoch[2/5], Step[37], Loss:755.5689
NE:0.2888, TC:73.9920, CC:314.0400, OV:6.6169, PN:360.6312
Epoch[2/5], Step[38], Loss:851.6497
NE:0.1910, TC:56.0292, CC:426.3784, OV:0.6532, PN:368.3979
Epoch[2/5], Step[39], Loss:857.9966
NE:0.2810, TC:72.0893, CC:301.2232, OV:7.3630, PN:477.0401
Epoch[2/5], Step[40], Loss:1140.5057
NE:0.2733, TC:71.4773, CC:533.6647, OV:2.8475, PN:532.2429
Epoch[2/5], Step[41], Loss:1117.6443
NE:0.2894, TC:75.3545, CC:464.9736, OV:8.8955, PN:568.1312
Epoch[2/5], Step[42], Loss:919.4409
NE:0.2574, TC:69.1307, CC:385.5718, OV:6.0551, PN:458.4259
Epoch[2/5], Step[43], Loss:914.8601
NE:0.2924, TC:70.3299, CC:334.7743, OV:7.7397, PN:501.7239
Epoch[2/5], Step[44], Loss:869.5775
NE:0.3102, TC:73.6936, CC:294.5135, OV:5.7411, PN:495.3190
Epoch[2/5], Step[45], Loss:1123.3156
NE:0.2418, TC:63.1133, CC:392.1622, OV:1.5297, PN:666.2685
Epoch[2/5], Step[46], Loss:878.2988
NE:0.3163, TC:73.9532, CC:274.7446, OV:6.2250, PN:523.0596
Epoch[2/5], Step[47], Loss:874.2198
NE:0.2537, TC:65.6536, CC:368.9814, OV:1.5386, PN:437.7926
Epoch[2/5], Step[48], Loss:838.5073
NE:0.3023, TC:72.9210, CC:278.7000, OV:5.3341, PN:481.2500
Epoch[2/5], Step[49], Loss:943.7057
NE:0.2800, TC:72.0594, CC:344.2679, OV:2.7652, PN:524.3333
Epoch[2/5], Step[50], Loss:814.4392
NE:0.3364, TC:80.0383, CC:250.5167, OV:9.0315, PN:474.5162
Epoch[2/5], Step[51], Loss:955.4934
NE:0.3305, TC:80.0677, CC:268.6645, OV:9.0112, PN:597.4194
Epoch[2/5], Step[52], Loss:708.5210
NE:0.3347, TC:76.6584, CC:242.6694, OV:7.8388, PN:381.0197
Epoch[2/5], Step[53], Loss:761.8906
NE:0.3203, TC:73.8159, CC:220.2105, OV:9.0440, PN:458.4998
Epoch[2/5], Step[54], Loss:1135.9561
NE:0.3526, TC:86.3763, CC:356.6598, OV:7.7865, PN:684.7809
Epoch[2/5], Step[55], Loss:1357.4978
NE:0.2324, TC:58.2562, CC:765.5364, OV:0.0479, PN:533.4250
Epoch[2/5], Step[56], Loss:829.0718
NE:0.1819, TC:53.0915, CC:289.6248, OV:0.0167, PN:486.1569
Epoch[2/5], Step[57], Loss:946.2292
NE:0.3376, TC:79.4858, CC:259.6983, OV:8.2464, PN:598.4611
Epoch[2/5], Step[58], Loss:812.8051
NE:0.2329, TC:57.9868, CC:253.1319, OV:0.6839, PN:500.7696
Epoch[2/5], Step[59], Loss:803.9905
NE:0.2540, TC:64.8300, CC:307.9056, OV:3.6200, PN:427.3809
Epoch[2/5], Step[60], Loss:927.1299
NE:0.2936, TC:68.9859, CC:291.4029, OV:4.5460, PN:561.9016
2026-01-12 21:23:11,076 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_2_step_60.pth
Epoch[2/5], Step[61], Loss:1021.2716
NE:0.2718, TC:72.7195, CC:369.9009, OV:4.0183, PN:574.3611
Epoch[2/5], Step[62], Loss:1113.0734
NE:0.2871, TC:77.0497, CC:478.5030, OV:0.7080, PN:556.5256

Epoch = 3  lr = 6.7178307232810015e-06
Epoch[3/5], Step[0], Loss:854.6835
NE:0.3009, TC:72.7996, CC:275.7767, OV:6.2196, PN:499.5866
2026-01-12 21:23:34,214 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_3_step_0.pth
Epoch[3/5], Step[1], Loss:1122.3204
NE:0.2883, TC:79.1161, CC:350.6988, OV:0.7015, PN:691.5157
Epoch[3/5], Step[2], Loss:812.8247
NE:0.2835, TC:69.0278, CC:288.7613, OV:5.7893, PN:448.9628
Epoch[3/5], Step[3], Loss:570.0779
NE:0.1315, TC:46.8961, CC:214.7519, OV:0.0007, PN:308.2979
Epoch[3/5], Step[4], Loss:1086.8494
NE:0.2353, TC:70.4867, CC:538.4878, OV:0.6960, PN:476.9437
Epoch[3/5], Step[5], Loss:1020.2851
NE:0.2016, TC:57.1452, CC:421.5997, OV:1.5180, PN:539.8206
Epoch[3/5], Step[6], Loss:991.1237
NE:0.2190, TC:59.2568, CC:474.9353, OV:0.2906, PN:456.4221
Epoch[3/5], Step[7], Loss:840.2854
NE:0.2335, TC:64.0123, CC:401.1111, OV:0.7069, PN:374.2216
Epoch[3/5], Step[8], Loss:1012.0958
NE:0.2686, TC:74.7612, CC:444.6201, OV:5.2981, PN:487.1478
Epoch[3/5], Step[9], Loss:731.3423
NE:0.2716, TC:70.1195, CC:299.2432, OV:6.5909, PN:355.1171
Epoch[3/5], Step[10], Loss:763.8973
NE:0.2684, TC:68.8629, CC:294.9059, OV:7.7921, PN:392.0680
Epoch[3/5], Step[11], Loss:859.2477
NE:0.2802, TC:74.1548, CC:314.7500, OV:8.9731, PN:461.0897
Epoch[3/5], Step[12], Loss:1009.9942
NE:0.2549, TC:69.2728, CC:365.1308, OV:6.5007, PN:568.8350
Epoch[3/5], Step[13], Loss:892.2511
NE:0.2702, TC:73.3040, CC:298.2444, OV:8.9628, PN:511.4697
Epoch[3/5], Step[14], Loss:867.5780
NE:0.2016, TC:60.1110, CC:404.7849, OV:2.3299, PN:400.1506
Epoch[3/5], Step[15], Loss:753.4929
NE:0.1702, TC:50.0776, CC:306.2064, OV:0.6572, PN:396.3815
Epoch[3/5], Step[16], Loss:764.1501
NE:0.1887, TC:55.0848, CC:328.0984, OV:1.4828, PN:379.2955
Epoch[3/5], Step[17], Loss:818.0720
NE:0.2704, TC:70.0633, CC:315.2304, OV:5.3392, PN:427.1686
Epoch[3/5], Step[18], Loss:880.0027
NE:0.2531, TC:63.0298, CC:317.7248, OV:4.5205, PN:494.4746
Epoch[3/5], Step[19], Loss:921.3340
NE:0.2393, TC:64.8084, CC:359.8502, OV:5.9896, PN:490.4465
Epoch[3/5], Step[20], Loss:768.2072
NE:0.2580, TC:66.1104, CC:293.2335, OV:7.3300, PN:401.2753
Epoch[3/5], Step[21], Loss:974.3226
NE:0.2443, TC:67.3910, CC:457.3824, OV:2.8043, PN:446.5006
Epoch[3/5], Step[22], Loss:805.7737
NE:0.2700, TC:69.4634, CC:289.7756, OV:8.1808, PN:438.0838
Epoch[3/5], Step[23], Loss:770.0400
NE:0.2088, TC:55.3625, CC:341.2845, OV:3.5806, PN:369.6038
Epoch[3/5], Step[24], Loss:957.2523
NE:0.2295, TC:64.7597, CC:393.2254, OV:3.9801, PN:495.0576
Epoch[3/5], Step[25], Loss:712.3610
NE:0.2775, TC:68.5270, CC:271.5473, OV:7.3922, PN:364.6170
Epoch[3/5], Step[26], Loss:883.7328
NE:0.2977, TC:73.8458, CC:277.7820, OV:8.2184, PN:523.5889
Epoch[3/5], Step[27], Loss:1029.9470
NE:0.2626, TC:70.8980, CC:489.8759, OV:3.5822, PN:465.3284
Epoch[3/5], Step[28], Loss:762.5259
NE:0.1936, TC:51.3987, CC:316.3521, OV:2.3039, PN:392.2776
Epoch[3/5], Step[29], Loss:754.6790
NE:0.3081, TC:75.3318, CC:243.0424, OV:9.0049, PN:426.9919
Epoch[3/5], Step[30], Loss:992.6614
NE:0.3003, TC:70.8991, CC:336.8795, OV:4.9314, PN:579.6510
Epoch[3/5], Step[31], Loss:899.2141
NE:0.2572, TC:64.2772, CC:374.4494, OV:6.3864, PN:453.8440
Epoch[3/5], Step[32], Loss:938.2140
NE:0.2303, TC:62.3846, CC:329.8152, OV:0.0239, PN:545.7600
Epoch[3/5], Step[33], Loss:943.3148
NE:0.2509, TC:67.6222, CC:362.8333, OV:1.9510, PN:510.6573
Epoch[3/5], Step[34], Loss:656.3247
NE:0.3064, TC:74.6707, CC:256.4366, OV:7.4117, PN:317.4994
Epoch[3/5], Step[35], Loss:1059.2755
NE:0.2524, TC:64.3611, CC:341.2347, OV:1.5346, PN:651.8928
Epoch[3/5], Step[36], Loss:1363.4941
NE:0.2042, TC:50.2778, CC:842.0284, OV:0.0479, PN:470.9359
Epoch[3/5], Step[37], Loss:1045.4851
NE:0.2746, TC:68.3949, CC:472.9798, OV:2.8390, PN:500.9969
Epoch[3/5], Step[38], Loss:964.3053
NE:0.3173, TC:77.5090, CC:297.6950, OV:6.5805, PN:582.2036
Epoch[3/5], Step[39], Loss:699.7654
NE:0.2896, TC:68.0785, CC:208.5385, OV:9.0111, PN:413.8476
Epoch[3/5], Step[40], Loss:1013.1070
NE:0.2181, TC:59.3120, CC:494.4577, OV:1.5176, PN:457.6016
Epoch[3/5], Step[41], Loss:789.3875
NE:0.1825, TC:49.8121, CC:246.1183, OV:0.0167, PN:493.2579
Epoch[3/5], Step[42], Loss:844.5744
NE:0.2648, TC:64.4727, CC:302.8051, OV:7.7024, PN:469.3293
Epoch[3/5], Step[43], Loss:796.2483
NE:0.2229, TC:58.4997, CC:360.0591, OV:1.5215, PN:375.9452
Epoch[3/5], Step[44], Loss:980.7312
NE:0.2507, TC:66.2255, CC:393.8905, OV:2.3382, PN:518.0262
Epoch[3/5], Step[45], Loss:778.7472
NE:0.2530, TC:62.8087, CC:291.4294, OV:5.2833, PN:418.9729
Epoch[3/5], Step[46], Loss:674.0384
NE:0.2752, TC:64.1029, CC:237.3454, OV:6.1139, PN:366.2009
Epoch[3/5], Step[47], Loss:876.4811
NE:0.2820, TC:71.3021, CC:311.0031, OV:7.3397, PN:486.5540
Epoch[3/5], Step[48], Loss:877.6580
NE:0.2242, TC:62.5535, CC:373.3546, OV:2.7313, PN:438.7943
Epoch[3/5], Step[49], Loss:731.6342
NE:0.2022, TC:52.4722, CC:245.4257, OV:0.6734, PN:432.8607
Epoch[3/5], Step[50], Loss:867.8312
NE:0.2374, TC:63.7104, CC:350.4705, OV:6.0255, PN:447.3873
Epoch[3/5], Step[51], Loss:959.2601
NE:0.2166, TC:58.4133, CC:437.7003, OV:2.7682, PN:460.1617
Epoch[3/5], Step[52], Loss:1089.6462
NE:0.2446, TC:64.7212, CC:412.1050, OV:0.6877, PN:611.8878
Epoch[3/5], Step[53], Loss:1026.3605
NE:0.2233, TC:64.3917, CC:491.9457, OV:8.8242, PN:460.9756
Epoch[3/5], Step[54], Loss:725.2889
NE:0.1822, TC:51.0458, CC:348.6533, OV:0.6451, PN:324.7626
Epoch[3/5], Step[55], Loss:820.9927
NE:0.2604, TC:67.4030, CC:263.6932, OV:6.9348, PN:482.7014
Epoch[3/5], Step[56], Loss:1083.5686
NE:0.2744, TC:75.1547, CC:430.2351, OV:7.7101, PN:570.1943
Epoch[3/5], Step[57], Loss:774.0181
NE:0.2610, TC:65.0150, CC:290.0573, OV:5.6957, PN:412.9891
Epoch[3/5], Step[58], Loss:700.2550
NE:0.2778, TC:69.8473, CC:266.0143, OV:9.0137, PN:355.1019
Epoch[3/5], Step[59], Loss:917.2959
NE:0.2297, TC:61.9015, CC:369.4816, OV:2.7393, PN:482.9438
Epoch[3/5], Step[60], Loss:811.6561
NE:0.2571, TC:63.7740, CC:277.3958, OV:5.6690, PN:464.5602
2026-01-12 21:30:38,909 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_3_step_60.pth
Epoch[3/5], Step[61], Loss:910.5293
NE:0.2429, TC:65.1965, CC:448.6629, OV:3.2420, PN:393.1850
Epoch[3/5], Step[62], Loss:801.1638
NE:0.1898, TC:52.6156, CC:355.6264, OV:1.0831, PN:391.6487

Epoch = 4  lr = 3.782169276719e-06
Epoch[4/5], Step[0], Loss:880.8553
NE:0.2102, TC:55.9683, CC:394.4323, OV:1.5180, PN:428.7265
2026-01-12 21:30:54,026 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_4_step_0.pth
Epoch[4/5], Step[1], Loss:825.6515
NE:0.1800, TC:52.5406, CC:381.2238, OV:0.6470, PN:391.0600
Epoch[4/5], Step[2], Loss:764.7831
NE:0.2589, TC:65.0156, CC:275.7445, OV:7.3246, PN:416.4395
Epoch[4/5], Step[3], Loss:861.0964
NE:0.2645, TC:69.5577, CC:313.2533, OV:7.3313, PN:470.6896
Epoch[4/5], Step[4], Loss:1044.8136
NE:0.2756, TC:75.1724, CC:313.6907, OV:0.6953, PN:654.9796
Epoch[4/5], Step[5], Loss:948.3609
NE:0.2767, TC:68.4266, CC:344.9929, OV:4.9217, PN:529.7430
Epoch[4/5], Step[6], Loss:961.9696
NE:0.2612, TC:72.7485, CC:425.3621, OV:0.6998, PN:462.8980
Epoch[4/5], Step[7], Loss:976.1595
NE:0.2213, TC:64.4265, CC:449.0019, OV:8.8206, PN:453.6893
Epoch[4/5], Step[8], Loss:914.5166
NE:0.2780, TC:72.8328, CC:321.0688, OV:6.5535, PN:513.7835
Epoch[4/5], Step[9], Loss:702.0269
NE:0.1959, TC:50.2817, CC:233.1948, OV:0.6705, PN:417.6840
Epoch[4/5], Step[10], Loss:821.5929
NE:0.2520, TC:63.8082, CC:280.2212, OV:5.6702, PN:471.6412
Epoch[4/5], Step[11], Loss:658.0399
NE:0.2712, TC:68.3296, CC:265.1208, OV:6.5833, PN:317.7350
Epoch[4/5], Step[12], Loss:849.1449
NE:0.2002, TC:58.3298, CC:391.9923, OV:6.3456, PN:392.2771
Epoch[4/5], Step[13], Loss:988.7394
NE:0.2391, TC:66.7184, CC:491.4958, OV:3.5664, PN:426.7197
Epoch[4/5], Step[14], Loss:940.2195
NE:0.2053, TC:60.6557, CC:422.3817, OV:1.9283, PN:455.0484
Epoch[4/5], Step[15], Loss:947.1343
NE:0.2264, TC:63.3745, CC:394.8714, OV:3.9741, PN:484.6879
Epoch[4/5], Step[16], Loss:971.7029
NE:0.2594, TC:67.8005, CC:330.5286, OV:6.4909, PN:566.6235
Epoch[4/5], Step[17], Loss:770.2977
NE:0.2622, TC:68.3635, CC:274.5835, OV:8.1798, PN:418.9086
Epoch[4/5], Step[18], Loss:912.0826
NE:0.2211, TC:59.4265, CC:384.7263, OV:2.7309, PN:464.9778
Epoch[4/5], Step[19], Loss:812.2787
NE:0.2366, TC:63.9103, CC:328.9015, OV:6.0329, PN:413.1974
Epoch[4/5], Step[20], Loss:840.4889
NE:0.1879, TC:51.3486, CC:359.0341, OV:1.0794, PN:428.8390
Epoch[4/5], Step[21], Loss:815.9580
NE:0.2132, TC:59.7817, CC:360.5152, OV:2.7194, PN:392.7285
Epoch[4/5], Step[22], Loss:766.4036
NE:0.2308, TC:61.1132, CC:294.6062, OV:5.2759, PN:405.1775
Epoch[4/5], Step[23], Loss:933.1100
NE:0.2438, TC:66.5795, CC:421.5510, OV:2.8022, PN:441.9334
Epoch[4/5], Step[24], Loss:875.5639
NE:0.2701, TC:71.1180, CC:266.1620, OV:8.9432, PN:529.0706
Epoch[4/5], Step[25], Loss:811.5042
NE:0.1913, TC:54.5653, CC:367.1755, OV:2.3140, PN:387.2581
Epoch[4/5], Step[26], Loss:821.9305
NE:0.2457, TC:61.9244, CC:311.8169, OV:7.6892, PN:440.2543
Epoch[4/5], Step[27], Loss:837.1248
NE:0.2811, TC:73.7511, CC:287.3832, OV:8.9718, PN:466.7375
Epoch[4/5], Step[28], Loss:755.3756
NE:0.2745, TC:69.8503, CC:252.9453, OV:8.9639, PN:423.3416
Epoch[4/5], Step[29], Loss:669.4399
NE:0.2736, TC:69.5248, CC:269.6921, OV:7.3804, PN:322.5690
Epoch[4/5], Step[30], Loss:868.3585
NE:0.2841, TC:71.5001, CC:271.2768, OV:8.2037, PN:517.0938
Epoch[4/5], Step[31], Loss:688.6589
NE:0.2749, TC:66.0247, CC:211.0336, OV:8.9953, PN:402.3303
Epoch[4/5], Step[32], Loss:668.1669
NE:0.2531, TC:61.0304, CC:242.1315, OV:6.0973, PN:358.6547
Epoch[4/5], Step[33], Loss:730.0144
NE:0.2921, TC:70.4621, CC:264.1646, OV:5.3375, PN:389.7583
Epoch[4/5], Step[34], Loss:812.4646
NE:0.2719, TC:63.8947, CC:262.3149, OV:4.5285, PN:481.4545
Epoch[4/5], Step[35], Loss:911.6042
NE:0.2512, TC:65.8111, CC:359.6244, OV:2.3378, PN:483.5797
Epoch[4/5], Step[36], Loss:641.7206
NE:0.1414, TC:48.1936, CC:261.5977, OV:0.0007, PN:331.7872
Epoch[4/5], Step[37], Loss:640.7289
NE:0.3045, TC:70.5938, CC:219.1592, OV:7.8059, PN:342.8655
Epoch[4/5], Step[38], Loss:984.3737
NE:0.2336, TC:60.3506, CC:444.8064, OV:1.5211, PN:477.4621
Epoch[4/5], Step[39], Loss:806.5250
NE:0.2946, TC:68.1520, CC:247.9922, OV:6.2034, PN:483.8829
Epoch[4/5], Step[40], Loss:830.7442
NE:0.2887, TC:70.3474, CC:231.8554, OV:6.9510, PN:521.3018
Epoch[4/5], Step[41], Loss:718.1379
NE:0.2352, TC:57.2609, CC:281.4329, OV:3.5892, PN:375.6197
Epoch[4/5], Step[42], Loss:852.0911
NE:0.2479, TC:65.1766, CC:290.8553, OV:5.9919, PN:489.8193
Epoch[4/5], Step[43], Loss:709.4192
NE:0.1779, TC:47.6979, CC:208.8931, OV:0.0167, PN:452.6334
Epoch[4/5], Step[44], Loss:1079.1926
NE:0.2927, TC:77.1716, CC:393.4514, OV:7.7277, PN:600.5491
Epoch[4/5], Step[45], Loss:933.5046
NE:0.2895, TC:76.2238, CC:367.0568, OV:5.3078, PN:484.6267
Epoch[4/5], Step[46], Loss:882.6573
NE:0.2611, TC:67.1226, CC:406.2614, OV:3.2484, PN:405.7640
Epoch[4/5], Step[47], Loss:687.1226
NE:0.2781, TC:67.0623, CC:239.7612, OV:7.3876, PN:372.6335
Epoch[4/5], Step[48], Loss:987.0033
NE:0.2201, TC:62.1786, CC:385.8622, OV:0.6831, PN:538.0591
Epoch[4/5], Step[49], Loss:770.4019
NE:0.1842, TC:50.0732, CC:278.3314, OV:0.6584, PN:441.1546
Epoch[4/5], Step[50], Loss:1172.7734
NE:0.1978, TC:53.6334, CC:702.9839, OV:0.0478, PN:415.9105
Epoch[4/5], Step[51], Loss:939.0241
NE:0.1931, TC:51.8551, CC:477.0215, OV:0.2809, PN:409.6735
Epoch[4/5], Step[52], Loss:917.9310
NE:0.2018, TC:54.7553, CC:435.1686, OV:2.7545, PN:425.0508
Epoch[4/5], Step[53], Loss:716.7917
NE:0.1645, TC:46.4658, CC:306.1109, OV:2.2864, PN:361.7641
Epoch[4/5], Step[54], Loss:879.0993
NE:0.1943, TC:54.5609, CC:364.0974, OV:0.0239, PN:460.2229
Epoch[4/5], Step[55], Loss:912.2827
NE:0.1967, TC:54.5298, CC:340.6956, OV:1.5147, PN:515.3459
Epoch[4/5], Step[56], Loss:963.1682
NE:0.1894, TC:51.7096, CC:417.5918, OV:1.5032, PN:492.1743
Epoch[4/5], Step[57], Loss:1042.3459
NE:0.2330, TC:62.3781, CC:513.8948, OV:2.8208, PN:463.0192
Epoch[4/5], Step[58], Loss:781.5141
NE:0.2585, TC:63.0944, CC:279.9814, OV:5.7618, PN:432.4181
Epoch[4/5], Step[59], Loss:656.3206
NE:0.2913, TC:70.7843, CC:238.3434, OV:9.0232, PN:337.8783
Epoch[4/5], Step[60], Loss:884.2858
NE:0.2283, TC:61.7238, CC:399.5078, OV:0.7033, PN:422.1226
2026-01-12 21:38:08,991 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_4_step_60.pth
Epoch[4/5], Step[61], Loss:709.3879
NE:0.2162, TC:54.3279, CC:271.3126, OV:1.4825, PN:382.0488
Epoch[4/5], Step[62], Loss:747.5225
NE:0.2609, TC:65.5179, CC:269.7161, OV:5.6961, PN:406.3315

Epoch = 5  lr = 1.4071692767190003e-06
Epoch[5/5], Step[0], Loss:672.4347
NE:0.1817, TC:49.5234, CC:288.5412, OV:1.4703, PN:332.7181
2026-01-12 21:38:24,394 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_5_step_0.pth
Epoch[5/5], Step[1], Loss:815.2753
NE:0.2874, TC:74.3807, CC:271.5607, OV:8.9798, PN:460.0667
Epoch[5/5], Step[2], Loss:1077.1122
NE:0.2388, TC:62.2339, CC:431.0073, OV:0.6840, PN:582.9481
Epoch[5/5], Step[3], Loss:733.1774
NE:0.2896, TC:72.0566, CC:234.1836, OV:8.9822, PN:417.6652
Epoch[5/5], Step[4], Loss:752.8280
NE:0.2622, TC:65.7393, CC:271.8844, OV:5.6992, PN:409.2430
Epoch[5/5], Step[5], Loss:1023.1984
NE:0.2889, TC:76.1979, CC:375.6748, OV:7.7233, PN:563.3135
Epoch[5/5], Step[6], Loss:655.6901
NE:0.2853, TC:68.5566, CC:233.8878, OV:7.7982, PN:345.1622
Epoch[5/5], Step[7], Loss:793.0153
NE:0.2417, TC:64.3543, CC:309.3492, OV:6.0354, PN:413.0347
Epoch[5/5], Step[8], Loss:922.2952
NE:0.2686, TC:70.4612, CC:335.8682, OV:6.5344, PN:509.1628
Epoch[5/5], Step[9], Loss:935.6286
NE:0.2385, TC:64.5764, CC:374.7850, OV:2.3344, PN:493.6944
Epoch[5/5], Step[10], Loss:627.3565
NE:0.2887, TC:71.2338, CC:246.0535, OV:7.3958, PN:302.3847
Epoch[5/5], Step[11], Loss:755.2463
NE:0.2824, TC:70.1608, CC:269.9205, OV:5.3354, PN:409.5473
Epoch[5/5], Step[12], Loss:933.2975
NE:0.1881, TC:52.3680, CC:393.9143, OV:1.5053, PN:485.3219
Epoch[5/5], Step[13], Loss:974.2087
NE:0.2736, TC:74.5619, CC:404.3206, OV:5.2991, PN:489.7534
Epoch[5/5], Step[14], Loss:944.5997
NE:0.2853, TC:69.4755, CC:317.5988, OV:4.9242, PN:552.3159
Epoch[5/5], Step[15], Loss:902.8346
NE:0.2149, TC:55.4005, CC:439.2040, OV:0.2856, PN:407.7296
Epoch[5/5], Step[16], Loss:859.2325
NE:0.2799, TC:71.8900, CC:248.6811, OV:8.9487, PN:529.4329
Epoch[5/5], Step[17], Loss:641.3310
NE:0.1187, TC:38.5273, CC:290.1583, OV:0.0167, PN:312.5100
Epoch[5/5], Step[18], Loss:985.6437
NE:0.2439, TC:70.7416, CC:333.4459, OV:0.6869, PN:580.5255
Epoch[5/5], Step[19], Loss:935.0067
NE:0.2303, TC:62.5525, CC:381.8043, OV:3.9712, PN:486.4484
Epoch[5/5], Step[20], Loss:615.7996
NE:0.1439, TC:47.7649, CC:229.9561, OV:0.0007, PN:337.9340
Epoch[5/5], Step[21], Loss:865.4564
NE:0.2302, TC:62.8254, CC:314.2285, OV:2.7451, PN:485.4273
Epoch[5/5], Step[22], Loss:1000.8857
NE:0.2361, TC:64.3496, CC:474.0937, OV:3.2346, PN:458.9717
Epoch[5/5], Step[23], Loss:800.6272
NE:0.2723, TC:66.2376, CC:262.4091, OV:6.1882, PN:465.5201
Epoch[5/5], Step[24], Loss:925.2451
NE:0.1992, TC:53.7197, CC:449.9460, OV:2.7509, PN:418.6293
Epoch[5/5], Step[25], Loss:841.7174
NE:0.1949, TC:55.8824, CC:390.6493, OV:6.3302, PN:388.6606
Epoch[5/5], Step[26], Loss:799.0419
NE:0.2500, TC:62.2419, CC:290.6446, OV:7.6938, PN:438.2115
Epoch[5/5], Step[27], Loss:938.6892
NE:0.2042, TC:54.1611, CC:352.7441, OV:1.5133, PN:530.0664
Epoch[5/5], Step[28], Loss:703.6638
NE:0.1656, TC:45.9238, CC:304.4023, OV:2.2857, PN:350.8864
Epoch[5/5], Step[29], Loss:680.7056
NE:0.2650, TC:64.8785, CC:205.5334, OV:8.9877, PN:401.0409
Epoch[5/5], Step[30], Loss:752.4537
NE:0.1724, TC:48.7045, CC:355.9790, OV:0.6407, PN:346.9571
Epoch[5/5], Step[31], Loss:805.0359
NE:0.2601, TC:64.6599, CC:260.8228, OV:5.6751, PN:473.6181
Epoch[5/5], Step[32], Loss:735.5184
NE:0.1856, TC:50.9566, CC:330.8018, OV:3.5621, PN:350.0124
Epoch[5/5], Step[33], Loss:662.9371
NE:0.1879, TC:49.1599, CC:221.8983, OV:0.6677, PN:391.0234
Epoch[5/5], Step[34], Loss:829.9860
NE:0.2672, TC:68.3206, CC:306.7621, OV:7.3200, PN:447.3160
Epoch[5/5], Step[35], Loss:831.6448
NE:0.2463, TC:60.4063, CC:289.0311, OV:4.5117, PN:477.4494
Epoch[5/5], Step[36], Loss:946.1712
NE:0.2065, TC:56.9429, CC:457.6288, OV:1.5120, PN:429.8810
Epoch[5/5], Step[37], Loss:679.6754
NE:0.2764, TC:66.2886, CC:234.1106, OV:7.3859, PN:371.6138
Epoch[5/5], Step[38], Loss:763.6222
NE:0.2583, TC:63.4243, CC:269.5522, OV:5.7630, PN:424.6244
Epoch[5/5], Step[39], Loss:1367.4878
NE:0.1918, TC:49.0156, CC:837.2468, OV:0.0478, PN:480.9857
Epoch[5/5], Step[40], Loss:761.1576
NE:0.1850, TC:51.2088, CC:326.0990, OV:1.0814, PN:382.5835
Epoch[5/5], Step[41], Loss:1005.0050
NE:0.2384, TC:63.8065, CC:482.2706, OV:2.8267, PN:455.8627
Epoch[5/5], Step[42], Loss:751.1481
NE:0.2738, TC:66.6256, CC:243.5388, OV:7.3310, PN:433.3789
Epoch[5/5], Step[43], Loss:885.5403
NE:0.1933, TC:54.1786, CC:367.0383, OV:0.0239, PN:464.1062
Epoch[5/5], Step[44], Loss:801.3234
NE:0.1945, TC:54.9551, CC:302.7318, OV:0.6628, PN:442.7792
Epoch[5/5], Step[45], Loss:825.5966
NE:0.2869, TC:70.7348, CC:258.0608, OV:8.1982, PN:488.3159
Epoch[5/5], Step[46], Loss:903.9713
NE:0.2568, TC:71.3928, CC:404.2028, OV:0.6976, PN:427.4214
Epoch[5/5], Step[47], Loss:657.4709
NE:0.2840, TC:70.0676, CC:238.8200, OV:9.0131, PN:339.2863
Epoch[5/5], Step[48], Loss:746.6726
NE:0.2681, TC:68.0129, CC:255.1247, OV:8.1775, PN:415.0894
Epoch[5/5], Step[49], Loss:921.4557
NE:0.2298, TC:62.9693, CC:362.9000, OV:1.9367, PN:493.4198
Epoch[5/5], Step[50], Loss:955.5838
NE:0.2252, TC:64.8438, CC:426.0838, OV:8.8248, PN:455.6062
Epoch[5/5], Step[51], Loss:799.0325
NE:0.2725, TC:67.6472, CC:240.4960, OV:6.9343, PN:483.6825
Epoch[5/5], Step[52], Loss:840.8359
NE:0.2288, TC:62.2233, CC:402.7184, OV:0.7043, PN:374.9610
Epoch[5/5], Step[53], Loss:843.2170
NE:0.2100, TC:58.3670, CC:354.5204, OV:2.3252, PN:427.7944
Epoch[5/5], Step[54], Loss:825.2334
NE:0.2247, TC:61.7548, CC:305.4610, OV:5.9760, PN:451.8169
Epoch[5/5], Step[55], Loss:722.7650
NE:0.2398, TC:61.5155, CC:268.4919, OV:5.2798, PN:387.2379
Epoch[5/5], Step[56], Loss:834.3578
NE:0.2144, TC:55.7671, CC:380.0252, OV:1.5142, PN:396.8369
Epoch[5/5], Step[57], Loss:620.7594
NE:0.2873, TC:69.4129, CC:240.6107, OV:6.5941, PN:303.8545
Epoch[5/5], Step[58], Loss:925.1282
NE:0.2370, TC:66.1806, CC:444.6313, OV:3.5657, PN:410.5135
Epoch[5/5], Step[59], Loss:893.2676
NE:0.2511, TC:67.6261, CC:386.5584, OV:2.8070, PN:436.0251
Epoch[5/5], Step[60], Loss:633.7020
NE:0.2483, TC:60.6416, CC:231.4508, OV:6.0995, PN:335.2619
2026-01-12 21:45:18,589 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_5_step_60.pth
Epoch[5/5], Step[61], Loss:870.6881
NE:0.2189, TC:60.5808, CC:358.3360, OV:2.7249, PN:448.8275
Epoch[5/5], Step[62], Loss:931.5721
NE:0.2610, TC:67.8836, CC:291.6757, OV:6.4946, PN:565.2573
2026-01-12 21:45:34,378 INFO Training finished

### Predict ###

2026-01-12 21:45:34,393 INFO Initialising model
Number of genes: 313
2026-01-12 21:45:37,837 INFO Preparing data
Loaded nuclei
(382, 510)
88 patches available
Cell types: ['B', 'CD4Tconv/Treg', 'CD8T/CD8Tex', 'DC', 'Endothelial', 'Epithelial', 'Fibroblasts', 'Malignant', 'Mast', 'Mono/Macro', 'Myofibroblasts', 'NK', 'Neutrophils', 'Plasma', 'SMC']
2026-01-12 21:45:37,882 INFO Total number of patches: 88
2026-01-12 21:45:37,882 INFO Begin prediction
Predict using D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_1_step_60.pth
2026-01-12 21:47:56,657 INFO Preparing data
Loaded nuclei
(382, 510)
70 patches available
Cell types: ['B', 'CD4Tconv/Treg', 'CD8T/CD8Tex', 'DC', 'Endothelial', 'Epithelial', 'Fibroblasts', 'Malignant', 'Mast', 'Mono/Macro', 'Myofibroblasts', 'NK', 'Neutrophils', 'Plasma', 'SMC']
2026-01-12 21:47:56,692 INFO Total number of patches: 70
2026-01-12 21:47:56,692 INFO Begin prediction
Predict using D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_11_30/models/epoch_1_step_60.pth
2026-01-12 21:48:36,192 INFO Finished
Combining predictions
2 patches available
Num multiprocessing splits: 8
Processing...
Combining results
Saved segmentation to D:\2512-BROCK-CODING\BIDCell\cagrad_data\dataset_xenium_breast1_small/model_outputs/2026_01_12_21_11_30/test_output/epoch_1_step_60_connected.tif
Number of cells 852
Number of splits for multiprocessing: 8
Segmentation map pixel size:  (1798, 2400)
Saving temporary resized segmentation
Extracting cell expressions
Patch H 0:1798, W 0:2400
(1798, 2400)
Reading filtered transcripts
0.0 508.99520000000007 0.0 380.99484
Transforming x_location
Transforming y_location
0 2395 0 1793
Transforming x_location
Transforming y_location
0 2395 0 1793
Extracting cell-gene matrix chunks
Combining cell-gene matrix chunks
Obtained cell-gene matrix
Done

### Done ###
