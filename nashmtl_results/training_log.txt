### Preprocessing ###

Reading DAPI image
D:\2512-BROCK-CODING\BIDCell\example_data\dataset_xenium_breast1_small\morphology_mip_small.tif
DAPI shape h: 1800 w: 2400
Segmenting DAPI patches h: 1800 w: 2400
Nuclei image h: 382 w: 510
Finished segmenting, found 852 nuclei
Loading transcripts file
   Unnamed: 0    transcript_id  cell_id  ...  y_location z_location         qv
0     2565587  281496451551924       -1  ...   469.34515  10.958567  40.000000
1     2565590  281496451551927    44769  ...   327.25198  15.099401  40.000000
2     2565591  281496451551928    45392  ...   577.32130  11.937755  20.782797
3     2565592  281496451551929    46672  ...   365.75200  10.617414  40.000000
4     2565595  281496451551932       -1  ...   409.68720  11.384081  40.000000

[5 rows x 9 columns]
Filtering transcripts
Finished filtering
Saving csv...
<bound method NDFrame.head of         Unnamed: 0    transcript_id  cell_id  ...  y_location z_location         qv
0          2565587  281496451551924       -1  ...         257  10.958567  40.000000
1          2565590  281496451551927    44769  ...         115  15.099401  40.000000
2          2565591  281496451551928    45392  ...         365  11.937755  20.782797
3          2565592  281496451551929    46672  ...         154  10.617414  40.000000
4          2565595  281496451551932       -1  ...         198  11.384081  40.000000
...            ...              ...      ...  ...         ...        ...        ...
186141     3940032  281500747163393    43575  ...         243  16.281252  35.923073
186142     3940037  281500747163399    43517  ...           2  15.730230  40.000000
186143     3940039  281500747163401    43534  ...          37  15.751373  27.767600
186144     3940041  281500747163403    43543  ...         299  12.549458  40.000000
186145     3940042  281500747163404    43530  ...          26  17.624292  28.487734

[186146 rows x 9 columns]>
(186146, 9)
313 unique genes
Total height 382, width 510
Converting to maps
Patch: (0, 382, 0, 510)
Saved all maps
(382, 510)
Processing D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\expr_maps\all_genes_0_382_0_510.hdf5
Loaded gene expr maps from D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\expr_maps\all_genes_0_382_0_510.hdf5
[0, 382, 0, 510]
Shift by 0
88 patches
Shift by 24
70 patches
Number of cells 852
Number of splits for multiprocessing: 8
Segmentation map pixel size:  (1798, 2400)
Saving temporary resized segmentation
Extracting cell expressions
Patch H 0:1798, W 0:2400
(1798, 2400)
Reading filtered transcripts
0.0 508.99520000000007 0.0 380.99484
Transforming x_location
Transforming y_location
0 2395 0 1793
Transforming x_location
Transforming y_location
0 2395 0 1793
Extracting cell-gene matrix chunks
Combining cell-gene matrix chunks
Obtained cell-gene matrix
Done
Number of cells: 852
Number of splits for multiprocessing: 8
Computing simple annotation

### Training ###

Using device: cuda
2026-01-12 21:12:29,352 INFO Initialising model
Number of genes: 313
2026-01-12 21:12:30,251 INFO Preparing data
Loaded nuclei
(382, 510)
63 patches available
Cell types: ['B', 'CD4Tconv/Treg', 'CD8T/CD8Tex', 'DC', 'Endothelial', 'Epithelial', 'Fibroblasts', 'Malignant', 'Mast', 'Mono/Macro', 'Myofibroblasts', 'NK', 'Neutrophils', 'Plasma', 'SMC']
2026-01-12 21:12:30,287 INFO Total number of training examples: 63
2026-01-12 21:12:30,289 INFO Begin training

Epoch = 1  lr = 1e-05
Epoch[1/5], Step[0], Loss:3376.8208
NE:0.7371, TC:248.9335, CC:1486.4878, OV:8.8276, PN:1631.8348
2026-01-12 21:12:42,692 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_1_step_0.pth
Epoch[1/5], Step[1], Loss:3193.8735
NE:0.7422, TC:239.5132, CC:1356.8329, OV:4.3104, PN:1592.4749
Epoch[1/5], Step[2], Loss:2859.6064
NE:0.7531, TC:228.3851, CC:1180.1553, OV:8.2775, PN:1442.0355
Epoch[1/5], Step[3], Loss:2863.9185
NE:0.7579, TC:226.4388, CC:1081.3905, OV:7.3706, PN:1547.9608
Epoch[1/5], Step[4], Loss:2825.4348
NE:0.7979, TC:218.4762, CC:998.9470, OV:2.8092, PN:1604.4044
Epoch[1/5], Step[5], Loss:2697.8857
NE:0.7809, TC:212.2419, CC:982.9147, OV:3.3109, PN:1498.6373
Epoch[1/5], Step[6], Loss:2655.3613
NE:0.7600, TC:210.6508, CC:979.0726, OV:6.8792, PN:1457.9985
Epoch[1/5], Step[7], Loss:2698.8872
NE:0.7629, TC:204.6509, CC:924.0617, OV:2.7972, PN:1566.6145
Epoch[1/5], Step[8], Loss:2362.7710
NE:0.7979, TC:193.1451, CC:740.4675, OV:8.8191, PN:1419.5414
Epoch[1/5], Step[9], Loss:2440.6279
NE:0.7291, TC:185.4767, CC:781.0269, OV:0.4503, PN:1472.9448
Epoch[1/5], Step[10], Loss:2782.5942
NE:0.7364, TC:188.4834, CC:791.2441, OV:0.0264, PN:1802.1040
Epoch[1/5], Step[11], Loss:1987.5625
NE:0.7610, TC:179.8466, CC:696.9559, OV:6.6880, PN:1103.3109
Epoch[1/5], Step[12], Loss:2333.6689
NE:0.8020, TC:182.4767, CC:641.6262, OV:9.7227, PN:1499.0413
Epoch[1/5], Step[13], Loss:2334.9536
NE:0.7022, TC:176.9259, CC:848.1521, OV:0.0563, PN:1309.1172
Epoch[1/5], Step[14], Loss:2148.8318
NE:0.7519, TC:174.0793, CC:651.1835, OV:6.1989, PN:1316.6180
Epoch[1/5], Step[15], Loss:1513.4194
NE:0.7768, TC:167.9587, CC:557.8125, OV:7.1069, PN:779.7645
Epoch[1/5], Step[16], Loss:2156.6042
NE:0.7500, TC:173.8019, CC:610.8618, OV:0.8711, PN:1370.3195
Epoch[1/5], Step[17], Loss:2006.7764
NE:0.7710, TC:169.3811, CC:581.7262, OV:7.9591, PN:1246.9390
Epoch[1/5], Step[18], Loss:2278.5139
NE:0.7174, TC:163.6557, CC:603.2206, OV:3.0997, PN:1507.8206
Epoch[1/5], Step[19], Loss:1394.4076
NE:0.7433, TC:160.7980, CC:524.0360, OV:7.8902, PN:700.9401
Epoch[1/5], Step[20], Loss:1983.0200
NE:0.6868, TC:160.0461, CC:642.7319, OV:3.5721, PN:1175.9832
Epoch[1/5], Step[21], Loss:2065.1855
NE:0.7036, TC:157.8313, CC:545.7703, OV:3.0748, PN:1357.8055
Epoch[1/5], Step[22], Loss:1904.5343
NE:0.6895, TC:158.0647, CC:534.5220, OV:3.1158, PN:1208.1423
Epoch[1/5], Step[23], Loss:1919.6270
NE:0.7013, TC:144.5312, CC:475.0326, OV:5.2451, PN:1294.1167
Epoch[1/5], Step[24], Loss:2045.4836
NE:0.7242, TC:155.7487, CC:511.5445, OV:8.2318, PN:1369.2344
Epoch[1/5], Step[25], Loss:2192.1609
NE:0.6544, TC:141.5326, CC:525.3215, OV:0.0306, PN:1524.6217
Epoch[1/5], Step[26], Loss:1555.3579
NE:0.7028, TC:144.4237, CC:454.6696, OV:8.6423, PN:946.9194
Epoch[1/5], Step[27], Loss:1915.9265
NE:0.5895, TC:145.2400, CC:573.9187, OV:2.1710, PN:1194.0073
Epoch[1/5], Step[28], Loss:1954.0026
NE:0.5857, TC:138.3619, CC:545.1874, OV:1.2606, PN:1268.6069
Epoch[1/5], Step[29], Loss:1264.7742
NE:0.6403, TC:139.6024, CC:432.4148, OV:9.4002, PN:682.7164
Epoch[1/5], Step[30], Loss:1467.1422
NE:0.6226, TC:141.0230, CC:457.1373, OV:9.4225, PN:858.9368
Epoch[1/5], Step[31], Loss:1698.3667
NE:0.5663, TC:130.1344, CC:487.4684, OV:4.7913, PN:1075.4062
Epoch[1/5], Step[32], Loss:2050.1895
NE:0.5581, TC:136.6407, CC:566.5045, OV:0.8087, PN:1345.6775
Epoch[1/5], Step[33], Loss:1756.7853
NE:0.5596, TC:135.1011, CC:525.2359, OV:6.3960, PN:1089.4927
Epoch[1/5], Step[34], Loss:1694.1038
NE:0.4723, TC:133.0356, CC:606.6986, OV:0.7838, PN:953.1133
Epoch[1/5], Step[35], Loss:1396.9583
NE:0.5514, TC:130.2661, CC:425.8995, OV:9.3777, PN:830.8635
Epoch[1/5], Step[36], Loss:1485.9644
NE:0.5198, TC:126.6540, CC:487.2002, OV:5.5822, PN:866.0081
Epoch[1/5], Step[37], Loss:1562.6976
NE:0.5319, TC:131.2354, CC:465.7342, OV:7.3047, PN:957.8915
Epoch[1/5], Step[38], Loss:1762.1295
NE:0.4889, TC:131.3717, CC:579.0388, OV:4.2881, PN:1046.9420
Epoch[1/5], Step[39], Loss:1920.0280
NE:0.4573, TC:127.7884, CC:586.8046, OV:1.6839, PN:1203.2937
Epoch[1/5], Step[40], Loss:1611.1282
NE:0.5018, TC:134.9509, CC:590.1512, OV:5.6179, PN:879.9064
Epoch[1/5], Step[41], Loss:1788.1470
NE:0.4291, TC:132.6384, CC:667.6398, OV:0.0007, PN:987.4390
Epoch[1/5], Step[42], Loss:1464.9053
NE:0.4366, TC:117.5490, CC:511.0933, OV:1.6419, PN:834.1845
Epoch[1/5], Step[43], Loss:1324.7339
NE:0.4851, TC:122.5660, CC:448.3058, OV:5.5873, PN:747.7896
Epoch[1/5], Step[44], Loss:1401.6516
NE:0.4866, TC:123.7354, CC:472.1123, OV:9.2973, PN:796.0200
Epoch[1/5], Step[45], Loss:1440.8699
NE:0.4049, TC:110.7695, CC:498.4327, OV:2.4927, PN:828.7701
Epoch[1/5], Step[46], Loss:1320.0603
NE:0.4370, TC:117.3155, CC:541.7230, OV:0.7969, PN:659.7880
Epoch[1/5], Step[47], Loss:1555.6287
NE:0.3986, TC:111.4238, CC:637.6844, OV:1.6429, PN:804.4789
Epoch[1/5], Step[48], Loss:1268.2665
NE:0.4466, TC:111.9935, CC:442.2978, OV:5.9820, PN:707.5466
Epoch[1/5], Step[49], Loss:1455.8229
NE:0.4411, TC:114.4760, CC:528.0445, OV:6.7148, PN:806.1464
Epoch[1/5], Step[50], Loss:1370.3625
NE:0.3925, TC:106.0459, CC:425.0998, OV:0.7641, PN:838.0603
Epoch[1/5], Step[51], Loss:1291.0565
NE:0.4614, TC:112.5866, CC:402.7537, OV:6.4144, PN:768.8404
Epoch[1/5], Step[52], Loss:1480.3718
NE:0.4409, TC:122.7930, CC:589.6349, OV:3.8053, PN:763.6978
Epoch[1/5], Step[53], Loss:1504.6426
NE:0.4157, TC:106.5203, CC:540.0702, OV:2.9330, PN:854.7033
Epoch[1/5], Step[54], Loss:1504.5037
NE:0.4079, TC:108.0439, CC:442.1346, OV:0.7528, PN:953.1644
Epoch[1/5], Step[55], Loss:1640.1149
NE:0.3866, TC:108.6405, CC:508.9791, OV:1.6457, PN:1020.4628
Epoch[1/5], Step[56], Loss:1221.0986
NE:0.4545, TC:108.0850, CC:403.9270, OV:5.9140, PN:702.7181
Epoch[1/5], Step[57], Loss:1620.3928
NE:0.4354, TC:118.6932, CC:441.7356, OV:0.7683, PN:1058.7604
Epoch[1/5], Step[58], Loss:1374.5962
NE:0.3837, TC:103.1186, CC:544.5875, OV:1.6266, PN:724.8798
Epoch[1/5], Step[59], Loss:1491.2861
NE:0.3914, TC:111.8570, CC:589.1847, OV:9.1723, PN:780.6808
Epoch[1/5], Step[60], Loss:1432.1329
NE:0.4048, TC:108.7529, CC:461.2867, OV:6.7421, PN:854.9465
2026-01-12 21:18:28,640 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_1_step_60.pth
Epoch[1/5], Step[61], Loss:1059.5072
NE:0.4221, TC:105.3808, CC:388.0081, OV:7.9991, PN:557.6970
Epoch[1/5], Step[62], Loss:1068.2406
NE:0.4171, TC:103.4035, CC:388.7820, OV:7.5804, PN:568.0577

Epoch = 2  lr = 9.092830723281e-06
Epoch[2/5], Step[0], Loss:1380.4000
NE:0.3985, TC:107.0125, CC:485.2569, OV:2.4692, PN:785.2630
2026-01-12 21:18:47,626 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_2_step_0.pth
Epoch[2/5], Step[1], Loss:1312.8059
NE:0.3637, TC:97.5257, CC:411.5058, OV:1.1764, PN:802.2343
Epoch[2/5], Step[2], Loss:1308.9163
NE:0.3988, TC:105.1721, CC:524.3958, OV:2.9316, PN:676.0180
Epoch[2/5], Step[3], Loss:1259.1438
NE:0.3891, TC:99.7550, CC:462.3042, OV:1.6214, PN:695.0741
Epoch[2/5], Step[4], Loss:1470.8176
NE:0.4079, TC:110.8940, CC:522.9563, OV:7.9432, PN:828.6163
Epoch[2/5], Step[5], Loss:1356.1885
NE:0.3741, TC:95.3607, CC:476.3726, OV:2.8952, PN:781.1860
Epoch[2/5], Step[6], Loss:1283.7699
NE:0.3962, TC:100.3614, CC:477.7794, OV:6.6197, PN:698.6132
Epoch[2/5], Step[7], Loss:956.3231
NE:0.4229, TC:102.8365, CC:343.7993, OV:9.1951, PN:500.0694
Epoch[2/5], Step[8], Loss:1164.4377
NE:0.4158, TC:99.2981, CC:359.0179, OV:6.3466, PN:699.3594
Epoch[2/5], Step[9], Loss:1024.8738
NE:0.4297, TC:101.4669, CC:347.2225, OV:5.4856, PN:570.2690
Epoch[2/5], Step[10], Loss:1242.6602
NE:0.3385, TC:96.3917, CC:472.3653, OV:2.4468, PN:671.1178
Epoch[2/5], Step[11], Loss:1088.1525
NE:0.3948, TC:97.3937, CC:370.6198, OV:5.8568, PN:613.8872
Epoch[2/5], Step[12], Loss:995.6240
NE:0.4106, TC:98.6897, CC:347.0211, OV:7.5608, PN:541.9418
Epoch[2/5], Step[13], Loss:1205.1415
NE:0.3655, TC:91.6727, CC:402.8641, OV:0.7143, PN:709.5248
Epoch[2/5], Step[14], Loss:1176.2084
NE:0.4387, TC:102.0239, CC:373.0832, OV:7.5338, PN:693.1288
Epoch[2/5], Step[15], Loss:1165.4198
NE:0.4439, TC:100.9846, CC:321.3171, OV:8.3633, PN:734.3109
Epoch[2/5], Step[16], Loss:1261.1732
NE:0.4375, TC:106.0684, CC:433.1766, OV:5.4670, PN:716.0238
Epoch[2/5], Step[17], Loss:1269.3635
NE:0.4309, TC:97.1695, CC:358.3844, OV:5.0455, PN:808.3333
Epoch[2/5], Step[18], Loss:1035.0995
NE:0.4346, TC:94.2386, CC:300.7741, OV:5.9130, PN:633.7391
Epoch[2/5], Step[19], Loss:1291.1816
NE:0.4455, TC:102.8573, CC:353.8509, OV:6.7216, PN:827.3064
Epoch[2/5], Step[20], Loss:1394.4177
NE:0.3850, TC:94.7539, CC:373.0864, OV:0.7394, PN:925.4529
Epoch[2/5], Step[21], Loss:1157.3149
NE:0.4165, TC:94.6496, CC:375.5019, OV:6.2114, PN:680.5356
Epoch[2/5], Step[22], Loss:1056.9153
NE:0.4502, TC:96.1910, CC:294.6239, OV:7.5107, PN:658.1393
Epoch[2/5], Step[23], Loss:1349.2449
NE:0.4087, TC:91.8896, CC:505.4054, OV:2.9173, PN:748.6238
Epoch[2/5], Step[24], Loss:1236.9836
NE:0.3517, TC:85.1627, CC:488.7897, OV:1.5808, PN:661.0987
Epoch[2/5], Step[25], Loss:1187.5737
NE:0.3996, TC:94.1764, CC:348.5587, OV:2.8463, PN:741.5927
Epoch[2/5], Step[26], Loss:1284.8186
NE:0.3387, TC:85.1175, CC:313.4054, OV:0.0173, PN:885.9396
Epoch[2/5], Step[27], Loss:1185.5447
NE:0.3689, TC:91.6058, CC:363.9484, OV:6.1508, PN:723.4708
Epoch[2/5], Step[28], Loss:1278.1028
NE:0.3344, TC:87.5559, CC:420.0182, OV:0.0247, PN:770.1696
Epoch[2/5], Step[29], Loss:1176.7478
NE:0.3466, TC:87.9941, CC:503.1429, OV:3.3177, PN:581.9465
Epoch[2/5], Step[30], Loss:1213.9023
NE:0.3455, TC:88.9531, CC:421.5770, OV:2.0119, PN:701.0150
Epoch[2/5], Step[31], Loss:938.1553
NE:0.3784, TC:92.0380, CC:323.5275, OV:9.1111, PN:513.1002
Epoch[2/5], Step[32], Loss:1050.2416
NE:0.2963, TC:81.2354, CC:407.5916, OV:1.5490, PN:559.5692
Epoch[2/5], Step[33], Loss:1317.5695
NE:0.3117, TC:81.0903, CC:411.2883, OV:1.5778, PN:823.3015
Epoch[2/5], Step[34], Loss:839.4376
NE:0.3552, TC:88.9376, CC:336.8676, OV:7.4855, PN:405.7917
Epoch[2/5], Step[35], Loss:1223.7247
NE:0.3379, TC:87.6130, CC:402.7202, OV:6.6081, PN:726.4456
Epoch[2/5], Step[36], Loss:1070.9797
NE:0.3243, TC:83.1160, CC:357.5276, OV:5.7698, PN:624.2419
Epoch[2/5], Step[37], Loss:1227.8301
NE:0.3112, TC:85.2044, CC:469.1779, OV:4.0750, PN:669.0617
Epoch[2/5], Step[38], Loss:945.4583
NE:0.3362, TC:83.7393, CC:296.0072, OV:9.1019, PN:556.2737
Epoch[2/5], Step[39], Loss:1077.5128
NE:0.3203, TC:80.2960, CC:357.9071, OV:4.5948, PN:634.3947
Epoch[2/5], Step[40], Loss:1277.8187
NE:0.3361, TC:92.2045, CC:377.8276, OV:0.7238, PN:806.7267
Epoch[2/5], Step[41], Loss:1202.3992
NE:0.3028, TC:88.6849, CC:570.0731, OV:3.6622, PN:539.6761
Epoch[2/5], Step[42], Loss:1031.6091
NE:0.3443, TC:86.5927, CC:327.6188, OV:7.0474, PN:610.0059
Epoch[2/5], Step[43], Loss:1042.0179
NE:0.3395, TC:90.5659, CC:362.7636, OV:9.0868, PN:579.2621
Epoch[2/5], Step[44], Loss:1061.1536
NE:0.3035, TC:82.9058, CC:466.2028, OV:0.7374, PN:511.0042
Epoch[2/5], Step[45], Loss:1027.8237
NE:0.2490, TC:71.6214, CC:379.8488, OV:0.6907, PN:575.4138
Epoch[2/5], Step[46], Loss:937.8477
NE:0.3319, TC:84.0956, CC:331.7274, OV:8.2675, PN:513.4252
Epoch[2/5], Step[47], Loss:1247.6497
NE:0.2679, TC:77.3734, CC:463.6242, OV:1.5632, PN:704.8209
Epoch[2/5], Step[48], Loss:861.5830
NE:0.3049, TC:77.3571, CC:314.8424, OV:6.1827, PN:462.8959
Epoch[2/5], Step[49], Loss:949.0847
NE:0.2773, TC:74.6526, CC:392.5258, OV:3.6578, PN:477.9712
Epoch[2/5], Step[50], Loss:1550.0859
NE:0.2381, TC:65.1276, CC:893.2871, OV:0.0480, PN:591.3851
Epoch[2/5], Step[51], Loss:1197.9370
NE:0.3071, TC:87.4742, CC:520.4357, OV:0.7248, PN:588.9952
Epoch[2/5], Step[52], Loss:1197.8870
NE:0.2944, TC:82.4940, CC:509.3528, OV:8.9569, PN:596.7891
Epoch[2/5], Step[53], Loss:776.4315
NE:0.3480, TC:84.5327, CC:292.4425, OV:6.6716, PN:392.4367
Epoch[2/5], Step[54], Loss:976.1947
NE:0.2220, TC:75.1472, CC:391.2665, OV:0.0007, PN:509.5583
Epoch[2/5], Step[55], Loss:828.7989
NE:0.3465, TC:83.1196, CC:297.2505, OV:7.8734, PN:440.2089
Epoch[2/5], Step[56], Loss:959.4028
NE:0.2541, TC:68.0236, CC:357.7482, OV:2.3574, PN:531.0195
Epoch[2/5], Step[57], Loss:1004.2528
NE:0.3473, TC:80.4269, CC:329.9040, OV:7.7984, PN:585.7762
Epoch[2/5], Step[58], Loss:918.9318
NE:0.3314, TC:79.7671, CC:301.6740, OV:5.3693, PN:531.7898
Epoch[2/5], Step[59], Loss:1044.9796
NE:0.2856, TC:69.1719, CC:444.2946, OV:0.3052, PN:530.9223
Epoch[2/5], Step[60], Loss:1064.9161
NE:0.3706, TC:88.9093, CC:286.4264, OV:9.0621, PN:680.1478
2026-01-12 21:24:50,716 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_2_step_60.pth
Epoch[2/5], Step[61], Loss:1157.1311
NE:0.3325, TC:81.3084, CC:367.3117, OV:2.8119, PN:705.3666
Epoch[2/5], Step[62], Loss:906.3477
NE:0.2755, TC:68.3584, CC:275.6861, OV:0.7008, PN:561.3269

Epoch = 3  lr = 6.7178307232810015e-06
Epoch[3/5], Step[0], Loss:882.2808
NE:0.3600, TC:82.8029, CC:288.3922, OV:5.7877, PN:504.9381
2026-01-12 21:25:02,332 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_3_step_0.pth
Epoch[3/5], Step[1], Loss:852.9731
NE:0.2995, TC:73.8228, CC:314.1809, OV:3.6534, PN:461.0166
Epoch[3/5], Step[2], Loss:1059.8646
NE:0.2862, TC:72.9058, CC:410.7073, OV:2.8185, PN:573.1468
Epoch[3/5], Step[3], Loss:1094.2316
NE:0.3598, TC:87.8219, CC:341.9677, OV:6.6366, PN:657.4456
Epoch[3/5], Step[4], Loss:1188.9996
NE:0.3216, TC:79.9053, CC:503.0863, OV:2.8785, PN:602.8079
Epoch[3/5], Step[5], Loss:1039.3325
NE:0.3480, TC:85.3165, CC:302.0241, OV:9.0438, PN:642.6001
Epoch[3/5], Step[6], Loss:1065.2501
NE:0.2912, TC:76.2798, CC:382.5403, OV:2.7932, PN:603.3455
Epoch[3/5], Step[7], Loss:1195.6736
NE:0.2675, TC:72.0242, CC:423.8805, OV:1.5603, PN:697.9410
Epoch[3/5], Step[8], Loss:1099.3953
NE:0.2510, TC:67.1637, CC:529.7271, OV:1.5367, PN:500.7167
Epoch[3/5], Step[9], Loss:1112.9199
NE:0.2734, TC:73.0242, CC:403.3252, OV:0.0240, PN:636.2731
Epoch[3/5], Step[10], Loss:946.1813
NE:0.3192, TC:78.1428, CC:313.6927, OV:6.2396, PN:547.7870
Epoch[3/5], Step[11], Loss:1223.4333
NE:0.2697, TC:73.0171, CC:472.2865, OV:0.7022, PN:677.1580
Epoch[3/5], Step[12], Loss:785.0922
NE:0.3275, TC:81.0251, CC:290.4340, OV:9.0662, PN:404.2393
Epoch[3/5], Step[13], Loss:993.8112
NE:0.2897, TC:73.4358, CC:343.7639, OV:5.7216, PN:570.6003
Epoch[3/5], Step[14], Loss:973.0452
NE:0.3046, TC:78.8426, CC:373.6895, OV:7.3888, PN:512.8197
Epoch[3/5], Step[15], Loss:1236.7261
NE:0.2940, TC:83.4692, CC:508.9776, OV:7.7762, PN:636.2090
Epoch[3/5], Step[16], Loss:1463.9788
NE:0.2316, TC:62.9272, CC:854.0062, OV:0.0479, PN:546.7659
Epoch[3/5], Step[17], Loss:831.1200
NE:0.2922, TC:74.6657, CC:279.2307, OV:9.0424, PN:467.8890
Epoch[3/5], Step[18], Loss:854.0817
NE:0.2014, TC:58.9565, CC:359.7233, OV:2.3265, PN:432.8740
Epoch[3/5], Step[19], Loss:943.3401
NE:0.2775, TC:70.8624, CC:341.9399, OV:4.5561, PN:525.7043
Epoch[3/5], Step[20], Loss:948.8555
NE:0.2973, TC:80.5145, CC:350.5622, OV:9.0210, PN:508.4605
Epoch[3/5], Step[21], Loss:910.6511
NE:0.2952, TC:78.0923, CC:330.6940, OV:8.2298, PN:493.3396
Epoch[3/5], Step[22], Loss:1002.6242
NE:0.2522, TC:71.6622, CC:480.0920, OV:0.7187, PN:449.8990
Epoch[3/5], Step[23], Loss:1035.7557
NE:0.2650, TC:72.8324, CC:505.6328, OV:3.2647, PN:453.7608
Epoch[3/5], Step[24], Loss:961.9908
NE:0.2497, TC:70.5954, CC:413.7614, OV:6.4285, PN:470.9559
Epoch[3/5], Step[25], Loss:957.5721
NE:0.2860, TC:71.8296, CC:365.5797, OV:7.7497, PN:512.1271
Epoch[3/5], Step[26], Loss:1189.9453
NE:0.3103, TC:85.9664, CC:368.4488, OV:0.7125, PN:734.5074
Epoch[3/5], Step[27], Loss:885.9378
NE:0.2143, TC:62.0337, CC:304.8248, OV:0.6788, PN:518.1862
Epoch[3/5], Step[28], Loss:1124.7456
NE:0.2557, TC:67.3669, CC:378.9374, OV:1.5366, PN:676.6489
Epoch[3/5], Step[29], Loss:847.6571
NE:0.3184, TC:80.2992, CC:294.3310, OV:9.0306, PN:463.6780
Epoch[3/5], Step[30], Loss:1159.2546
NE:0.2752, TC:78.4268, CC:543.5199, OV:0.7088, PN:536.3240
Epoch[3/5], Step[31], Loss:1129.5641
NE:0.2687, TC:74.7823, CC:512.0469, OV:8.8937, PN:533.5725
Epoch[3/5], Step[32], Loss:957.6341
NE:0.2423, TC:66.0092, CC:427.4906, OV:1.5389, PN:462.3531
Epoch[3/5], Step[33], Loss:738.3863
NE:0.3136, TC:78.4066, CC:294.0129, OV:7.4238, PN:358.2293
Epoch[3/5], Step[34], Loss:1076.7135
NE:0.2705, TC:77.3015, CC:519.3965, OV:3.6097, PN:476.1354
Epoch[3/5], Step[35], Loss:1010.8079
NE:0.2551, TC:68.4281, CC:430.6229, OV:0.3025, PN:511.1992
Epoch[3/5], Step[36], Loss:872.3437
NE:0.3036, TC:77.1981, CC:313.9817, OV:5.3708, PN:475.4895
Epoch[3/5], Step[37], Loss:1089.5802
NE:0.2985, TC:82.1415, CC:460.6534, OV:5.3425, PN:541.1443
Epoch[3/5], Step[38], Loss:1063.6432
NE:0.2527, TC:71.5894, CC:429.6284, OV:4.0131, PN:558.1595
Epoch[3/5], Step[39], Loss:890.5588
NE:0.2109, TC:61.4066, CC:393.5784, OV:0.6626, PN:434.7003
Epoch[3/5], Step[40], Loss:980.8140
NE:0.2441, TC:68.4784, CC:402.7809, OV:2.3570, PN:506.9536
Epoch[3/5], Step[41], Loss:852.5717
NE:0.2822, TC:70.9180, CC:305.8181, OV:5.3233, PN:470.2301
Epoch[3/5], Step[42], Loss:1060.9048
NE:0.3050, TC:73.6383, CC:378.1223, OV:4.9458, PN:603.8936
Epoch[3/5], Step[43], Loss:881.2048
NE:0.2906, TC:71.8677, CC:315.8492, OV:5.8052, PN:487.3921
Epoch[3/5], Step[44], Loss:959.8953
NE:0.2650, TC:70.5802, CC:384.6758, OV:2.7590, PN:501.6154
Epoch[3/5], Step[45], Loss:763.5836
NE:0.3106, TC:75.3329, CC:278.5567, OV:7.8317, PN:401.5516
Epoch[3/5], Step[46], Loss:1047.3407
NE:0.2746, TC:74.2961, CC:467.7341, OV:2.8286, PN:502.2073
Epoch[3/5], Step[47], Loss:1061.9778
NE:0.2918, TC:75.3716, CC:348.1888, OV:6.5410, PN:631.5846
Epoch[3/5], Step[48], Loss:828.6234
NE:0.2109, TC:63.7876, CC:270.3871, OV:0.0007, PN:494.2371
Epoch[3/5], Step[49], Loss:754.5643
NE:0.3030, TC:73.3952, CC:277.2352, OV:7.4276, PN:396.2033
Epoch[3/5], Step[50], Loss:966.0667
NE:0.2514, TC:69.8037, CC:370.0789, OV:6.0230, PN:519.9097
Epoch[3/5], Step[51], Loss:738.4840
NE:0.2942, TC:68.4593, CC:259.9335, OV:6.1426, PN:403.6545
Epoch[3/5], Step[52], Loss:808.8112
NE:0.2267, TC:58.4256, CC:275.7015, OV:0.6834, PN:473.7740
Epoch[3/5], Step[53], Loss:923.5207
NE:0.3111, TC:76.0450, CC:275.8853, OV:6.9793, PN:564.2999
Epoch[3/5], Step[54], Loss:1039.0477
NE:0.2765, TC:72.8341, CC:371.8487, OV:1.9655, PN:592.1229
Epoch[3/5], Step[55], Loss:661.2920
NE:0.3361, TC:77.2915, CC:253.9554, OV:6.6381, PN:323.0710
Epoch[3/5], Step[56], Loss:967.5141
NE:0.2769, TC:72.9206, CC:371.1607, OV:2.3614, PN:520.7945
Epoch[3/5], Step[57], Loss:776.9017
NE:0.1418, TC:47.6873, CC:353.4976, OV:0.0167, PN:375.5583
Epoch[3/5], Step[58], Loss:897.6931
NE:0.2645, TC:69.0195, CC:365.7978, OV:6.0610, PN:456.5503
Epoch[3/5], Step[59], Loss:941.9346
NE:0.3223, TC:78.0307, CC:288.4627, OV:8.2345, PN:566.8843
Epoch[3/5], Step[60], Loss:811.7561
NE:0.2293, TC:60.8355, CC:349.0021, OV:1.4988, PN:400.1903
2026-01-12 21:31:00,197 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_3_step_60.pth
Epoch[3/5], Step[61], Loss:934.3572
NE:0.2429, TC:62.0482, CC:349.1676, OV:1.1023, PN:521.7961
Epoch[3/5], Step[62], Loss:824.5129
NE:0.3151, TC:73.2682, CC:270.7060, OV:7.3747, PN:472.8490

Epoch = 4  lr = 3.782169276719e-06
Epoch[4/5], Step[0], Loss:1141.6378
NE:0.3085, TC:73.2270, CC:494.0717, OV:2.8557, PN:571.1749
2026-01-12 21:31:16,106 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_4_step_0.pth
Epoch[4/5], Step[1], Loss:803.2631
NE:0.3105, TC:73.4724, CC:274.5353, OV:5.7411, PN:449.2038
Epoch[4/5], Step[2], Loss:946.0201
NE:0.2755, TC:70.8809, CC:361.9753, OV:2.7590, PN:510.1295
Epoch[4/5], Step[3], Loss:1101.5227
NE:0.3007, TC:81.2949, CC:459.6027, OV:0.7147, PN:559.6098
Epoch[4/5], Step[4], Loss:1050.5271
NE:0.2378, TC:62.9661, CC:505.9424, OV:1.5265, PN:479.8543
Epoch[4/5], Step[5], Loss:1293.2085
NE:0.2703, TC:64.2229, CC:719.8336, OV:0.0479, PN:508.8338
Epoch[4/5], Step[6], Loss:798.1993
NE:0.1770, TC:61.3941, CC:319.6146, OV:0.0007, PN:417.0130
Epoch[4/5], Step[7], Loss:921.8728
NE:0.2709, TC:70.7682, CC:317.4460, OV:6.0227, PN:527.3651
Epoch[4/5], Step[8], Loss:1039.2374
NE:0.2734, TC:74.6600, CC:502.0610, OV:3.5983, PN:458.6446
Epoch[4/5], Step[9], Loss:869.4771
NE:0.2273, TC:63.3557, CC:345.8496, OV:0.6660, PN:459.3785
Epoch[4/5], Step[10], Loss:906.0377
NE:0.3311, TC:78.7372, CC:297.3045, OV:7.3906, PN:522.2744
Epoch[4/5], Step[11], Loss:828.0139
NE:0.3232, TC:75.0509, CC:256.4123, OV:7.3883, PN:488.8393
Epoch[4/5], Step[12], Loss:711.5972
NE:0.3320, TC:75.4599, CC:244.9683, OV:7.4378, PN:383.3992
Epoch[4/5], Step[13], Loss:897.9831
NE:0.2415, TC:66.2133, CC:295.6329, OV:0.6824, PN:535.2131
Epoch[4/5], Step[14], Loss:922.4527
NE:0.3356, TC:77.7256, CC:246.0479, OV:6.9968, PN:591.3468
Epoch[4/5], Step[15], Loss:1036.7994
NE:0.3245, TC:79.0134, CC:338.9469, OV:6.5815, PN:611.9331
Epoch[4/5], Step[16], Loss:779.5975
NE:0.2936, TC:69.0468, CC:261.2039, OV:5.3187, PN:443.7346
Epoch[4/5], Step[17], Loss:710.0485
NE:0.3130, TC:70.3940, CC:240.0709, OV:6.1487, PN:393.1218
Epoch[4/5], Step[18], Loss:810.3491
NE:0.3251, TC:72.8907, CC:251.7218, OV:5.8170, PN:479.5945
Epoch[4/5], Step[19], Loss:914.4795
NE:0.2792, TC:70.5266, CC:334.5420, OV:6.0619, PN:503.0698
Epoch[4/5], Step[20], Loss:631.2074
NE:0.3520, TC:79.5915, CC:237.6127, OV:7.4378, PN:306.2134
Epoch[4/5], Step[21], Loss:925.3595
NE:0.3085, TC:70.8208, CC:269.5093, OV:4.5583, PN:580.1624
Epoch[4/5], Step[22], Loss:715.5148
NE:0.3391, TC:74.5415, CC:198.3482, OV:9.0514, PN:433.2346
Epoch[4/5], Step[23], Loss:948.0669
NE:0.2990, TC:73.5252, CC:407.3245, OV:3.2700, PN:463.6482
Epoch[4/5], Step[24], Loss:1145.3738
NE:0.2716, TC:65.2593, CC:350.2378, OV:1.5393, PN:728.0659
Epoch[4/5], Step[25], Loss:993.9973
NE:0.3102, TC:73.4231, CC:343.4224, OV:2.3624, PN:574.4793
Epoch[4/5], Step[26], Loss:950.8378
NE:0.2756, TC:66.7033, CC:392.7571, OV:0.3012, PN:490.8006
Epoch[4/5], Step[27], Loss:1128.6157
NE:0.3107, TC:82.6829, CC:300.6081, OV:0.7080, PN:744.3061
Epoch[4/5], Step[28], Loss:1062.9717
NE:0.2998, TC:73.6714, CC:352.8318, OV:4.0261, PN:632.1427
Epoch[4/5], Step[29], Loss:1062.7556
NE:0.3219, TC:77.1790, CC:291.8089, OV:6.5568, PN:686.8891
Epoch[4/5], Step[30], Loss:780.9844
NE:0.3505, TC:80.1986, CC:230.2626, OV:9.0369, PN:461.1359
Epoch[4/5], Step[31], Loss:897.1444
NE:0.3425, TC:82.0857, CC:273.6481, OV:9.0386, PN:532.0295
Epoch[4/5], Step[32], Loss:1073.6249
NE:0.2603, TC:66.9134, CC:334.8613, OV:1.5365, PN:670.0533
Epoch[4/5], Step[33], Loss:931.9736
NE:0.3432, TC:80.3471, CC:242.0915, OV:9.0141, PN:600.1777
Epoch[4/5], Step[34], Loss:762.4266
NE:0.2349, TC:56.8204, CC:234.6160, OV:0.6812, PN:470.0742
Epoch[4/5], Step[35], Loss:704.6787
NE:0.3293, TC:75.6107, CC:234.9234, OV:7.8372, PN:385.9782
Epoch[4/5], Step[36], Loss:809.0769
NE:0.3208, TC:76.2307, CC:250.9136, OV:8.2322, PN:473.3796
Epoch[4/5], Step[37], Loss:1042.0994
NE:0.3254, TC:75.0065, CC:332.9759, OV:4.9530, PN:628.8386
Epoch[4/5], Step[38], Loss:918.8288
NE:0.2523, TC:66.7984, CC:389.7678, OV:6.4000, PN:455.6103
Epoch[4/5], Step[39], Loss:1079.3158
NE:0.2850, TC:73.5156, CC:444.6151, OV:8.8844, PN:552.0156
Epoch[4/5], Step[40], Loss:973.4663
NE:0.2874, TC:73.8884, CC:322.6295, OV:1.9690, PN:574.6920
Epoch[4/5], Step[41], Loss:962.7747
NE:0.2835, TC:73.9239, CC:403.6050, OV:2.8287, PN:482.1336
Epoch[4/5], Step[42], Loss:881.4488
NE:0.2690, TC:70.1146, CC:392.6321, OV:0.7173, PN:417.7158
Epoch[4/5], Step[43], Loss:906.7026
NE:0.3185, TC:77.3463, CC:270.6211, OV:8.2333, PN:550.1835
Epoch[4/5], Step[44], Loss:899.8276
NE:0.2776, TC:66.7285, CC:336.5518, OV:7.7178, PN:488.5518
Epoch[4/5], Step[45], Loss:901.9302
NE:0.2650, TC:67.0063, CC:298.9352, OV:5.6940, PN:530.0296
Epoch[4/5], Step[46], Loss:992.0522
NE:0.2234, TC:60.8172, CC:459.0366, OV:2.7766, PN:469.1984
Epoch[4/5], Step[47], Loss:845.0103
NE:0.3064, TC:75.1141, CC:272.4597, OV:5.3597, PN:491.7704
Epoch[4/5], Step[48], Loss:707.2135
NE:0.3126, TC:75.6754, CC:248.6154, OV:9.0504, PN:373.5598
Epoch[4/5], Step[49], Loss:823.7589
NE:0.2942, TC:71.4146, CC:273.0512, OV:6.2099, PN:472.7891
Epoch[4/5], Step[50], Loss:1038.9456
NE:0.2880, TC:77.6115, CC:441.5946, OV:5.3148, PN:514.1367
Epoch[4/5], Step[51], Loss:783.8319
NE:0.1962, TC:54.3873, CC:309.5172, OV:2.3134, PN:417.4179
Epoch[4/5], Step[52], Loss:1109.0403
NE:0.2856, TC:77.9675, CC:432.4688, OV:7.7353, PN:590.5832
Epoch[4/5], Step[53], Loss:908.1360
NE:0.2206, TC:59.3199, CC:418.0635, OV:1.5238, PN:429.0082
Epoch[4/5], Step[54], Loss:892.4222
NE:0.2304, TC:62.2395, CC:374.6626, OV:2.3386, PN:452.9512
Epoch[4/5], Step[55], Loss:952.5144
NE:0.2450, TC:65.1832, CC:374.8481, OV:2.7532, PN:509.4850
Epoch[4/5], Step[56], Loss:776.1909
NE:0.2130, TC:56.6048, CC:356.1013, OV:1.4881, PN:361.7837
Epoch[4/5], Step[57], Loss:832.3358
NE:0.1881, TC:53.6342, CC:279.6263, OV:0.0167, PN:498.8705
Epoch[4/5], Step[58], Loss:776.5918
NE:0.2377, TC:60.3582, CC:315.9993, OV:3.6024, PN:396.3942
Epoch[4/5], Step[59], Loss:844.6226
NE:0.2166, TC:57.7332, CC:343.3322, OV:1.0935, PN:442.2471
Epoch[4/5], Step[60], Loss:661.0405
NE:0.3177, TC:75.4540, CC:244.2607, OV:6.6271, PN:334.3809
2026-01-12 21:37:18,969 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_4_step_60.pth
Epoch[4/5], Step[61], Loss:894.9058
NE:0.2226, TC:60.4609, CC:329.4387, OV:0.0239, PN:504.7596
Epoch[4/5], Step[62], Loss:1140.4994
NE:0.2609, TC:67.4562, CC:443.5956, OV:0.6918, PN:628.4949

Epoch = 5  lr = 1.4071692767190003e-06
Epoch[5/5], Step[0], Loss:777.4880
NE:0.2017, TC:56.1235, CC:358.6601, OV:0.6536, PN:361.8491
2026-01-12 21:37:30,256 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_5_step_0.pth
Epoch[5/5], Step[1], Loss:873.8156
NE:0.2072, TC:60.2518, CC:332.7282, OV:0.0239, PN:480.6044
Epoch[5/5], Step[2], Loss:765.4015
NE:0.1966, TC:52.6635, CC:300.1621, OV:2.3056, PN:410.0737
Epoch[5/5], Step[3], Loss:1018.3715
NE:0.2591, TC:69.0663, CC:396.9644, OV:4.0019, PN:548.0798
Epoch[5/5], Step[4], Loss:1105.8075
NE:0.2953, TC:79.4885, CC:417.0187, OV:7.7423, PN:601.2627
Epoch[5/5], Step[5], Loss:861.1540
NE:0.3191, TC:78.8336, CC:270.3669, OV:9.0137, PN:502.6207
Epoch[5/5], Step[6], Loss:983.2092
NE:0.2176, TC:59.2590, CC:487.1205, OV:1.5176, PN:435.0945
Epoch[5/5], Step[7], Loss:698.5632
NE:0.2986, TC:71.0967, CC:248.7732, OV:7.4111, PN:370.9836
Epoch[5/5], Step[8], Loss:793.8832
NE:0.1695, TC:51.1342, CC:295.2158, OV:0.0167, PN:447.3469
Epoch[5/5], Step[9], Loss:992.6429
NE:0.2193, TC:60.7196, CC:368.6627, OV:1.5313, PN:561.5100
Epoch[5/5], Step[10], Loss:756.8021
NE:0.2437, TC:62.2595, CC:303.7438, OV:3.6077, PN:386.9475
Epoch[5/5], Step[11], Loss:1104.6067
NE:0.2905, TC:77.7382, CC:332.2561, OV:0.7000, PN:693.6219
Epoch[5/5], Step[12], Loss:805.1194
NE:0.2924, TC:70.0552, CC:269.7231, OV:5.7946, PN:459.2542
Epoch[5/5], Step[13], Loss:904.8553
NE:0.2836, TC:67.0799, CC:280.8524, OV:4.5408, PN:552.0986
Epoch[5/5], Step[14], Loss:720.2952
NE:0.2987, TC:70.6495, CC:212.1857, OV:9.0240, PN:428.1373
Epoch[5/5], Step[15], Loss:1042.7410
NE:0.2288, TC:59.8645, CC:380.0762, OV:1.5218, PN:601.0497
Epoch[5/5], Step[16], Loss:907.9344
NE:0.3083, TC:76.4812, CC:261.5586, OV:8.9875, PN:560.5988
Epoch[5/5], Step[17], Loss:997.5814
NE:0.2344, TC:61.2982, CC:432.9159, OV:2.7770, PN:500.3558
Epoch[5/5], Step[18], Loss:1000.3312
NE:0.2861, TC:72.5986, CC:310.7189, OV:6.5285, PN:610.1991
Epoch[5/5], Step[19], Loss:987.7238
NE:0.2626, TC:70.0938, CC:348.8698, OV:1.9590, PN:566.5385
Epoch[5/5], Step[20], Loss:1005.9818
NE:0.2747, TC:73.8070, CC:462.8195, OV:3.5926, PN:465.4880
Epoch[5/5], Step[21], Loss:867.4685
NE:0.2880, TC:68.9377, CC:259.9510, OV:5.7021, PN:532.5896
Epoch[5/5], Step[22], Loss:787.9313
NE:0.2721, TC:66.9040, CC:277.7368, OV:5.3036, PN:437.7147
Epoch[5/5], Step[23], Loss:892.3340
NE:0.2608, TC:65.8699, CC:341.1096, OV:0.3004, PN:484.7934
Epoch[5/5], Step[24], Loss:926.8380
NE:0.2550, TC:66.7027, CC:357.2132, OV:2.7454, PN:499.9218
Epoch[5/5], Step[25], Loss:960.0662
NE:0.2919, TC:75.9924, CC:329.2499, OV:6.5662, PN:547.9658
Epoch[5/5], Step[26], Loss:817.2063
NE:0.2984, TC:71.3257, CC:255.1141, OV:6.2152, PN:484.2529
Epoch[5/5], Step[27], Loss:867.2612
NE:0.3008, TC:74.6925, CC:252.1913, OV:6.9771, PN:533.0995
Epoch[5/5], Step[28], Loss:759.4397
NE:0.2973, TC:73.4528, CC:256.9116, OV:8.2151, PN:420.5630
Epoch[5/5], Step[29], Loss:987.2889
NE:0.2990, TC:71.7856, CC:342.9921, OV:4.9346, PN:567.2777
Epoch[5/5], Step[30], Loss:768.7502
NE:0.2164, TC:57.4765, CC:313.7170, OV:1.4890, PN:395.8514
Epoch[5/5], Step[31], Loss:947.0417
NE:0.2710, TC:69.6479, CC:370.9658, OV:2.3520, PN:503.8051
Epoch[5/5], Step[32], Loss:627.1522
NE:0.1338, TC:47.1812, CC:263.1429, OV:0.0007, PN:316.6937
Epoch[5/5], Step[33], Loss:803.6620
NE:0.2917, TC:70.1061, CC:270.9235, OV:7.3557, PN:454.9850
Epoch[5/5], Step[34], Loss:891.5424
NE:0.3053, TC:74.9864, CC:304.7512, OV:7.3647, PN:504.1347
Epoch[5/5], Step[35], Loss:879.0599
NE:0.2277, TC:61.6974, CC:360.8683, OV:2.3365, PN:453.9301
Epoch[5/5], Step[36], Loss:990.1426
NE:0.2191, TC:63.2752, CC:422.9730, OV:0.6841, PN:502.9911
Epoch[5/5], Step[37], Loss:733.3070
NE:0.3143, TC:76.0898, CC:246.3028, OV:9.0080, PN:401.5920
Epoch[5/5], Step[38], Loss:1053.2532
NE:0.2642, TC:74.9720, CC:477.7362, OV:0.7024, PN:499.5783
Epoch[5/5], Step[39], Loss:720.8502
NE:0.2011, TC:53.1699, CC:242.5607, OV:0.6751, PN:424.2434
Epoch[5/5], Step[40], Loss:661.2909
NE:0.3175, TC:76.2250, CC:255.6849, OV:7.4200, PN:321.6434
Epoch[5/5], Step[41], Loss:957.3903
NE:0.2551, TC:67.1348, CC:346.6588, OV:2.7610, PN:540.5807
Epoch[5/5], Step[42], Loss:906.9746
NE:0.2338, TC:64.0279, CC:351.5231, OV:5.9943, PN:485.1956
Epoch[5/5], Step[43], Loss:876.1193
NE:0.2633, TC:69.7870, CC:374.1348, OV:0.7167, PN:431.2174
Epoch[5/5], Step[44], Loss:996.0028
NE:0.2954, TC:79.4194, CC:399.1511, OV:5.3296, PN:511.8073
Epoch[5/5], Step[45], Loss:656.1715
NE:0.3203, TC:75.5980, CC:241.9323, OV:6.6274, PN:331.6935
Epoch[5/5], Step[46], Loss:878.9381
NE:0.2778, TC:66.5917, CC:318.5258, OV:7.7135, PN:485.8293
Epoch[5/5], Step[47], Loss:980.6812
NE:0.2738, TC:72.9907, CC:422.5807, OV:2.8294, PN:482.0066
Epoch[5/5], Step[48], Loss:726.2439
NE:0.3260, TC:75.7544, CC:259.2666, OV:5.3616, PN:385.5353
Epoch[5/5], Step[49], Loss:910.4324
NE:0.2282, TC:58.4613, CC:337.4499, OV:1.0962, PN:513.1967
Epoch[5/5], Step[50], Loss:750.0514
NE:0.2064, TC:55.5181, CC:218.6255, OV:0.6683, PN:475.0331
Epoch[5/5], Step[51], Loss:693.0225
NE:0.3068, TC:72.7634, CC:239.5054, OV:7.8194, PN:372.6275
Epoch[5/5], Step[52], Loss:856.7576
NE:0.2507, TC:66.0012, CC:344.9660, OV:6.0377, PN:439.5020
Epoch[5/5], Step[53], Loss:904.0936
NE:0.3157, TC:75.5996, CC:264.8349, OV:8.2264, PN:555.1169
Epoch[5/5], Step[54], Loss:903.8300
NE:0.2358, TC:63.7221, CC:388.2942, OV:6.3867, PN:445.1912
Epoch[5/5], Step[55], Loss:685.2641
NE:0.2818, TC:66.4863, CC:230.2833, OV:6.1298, PN:382.0829
Epoch[5/5], Step[56], Loss:1008.9883
NE:0.2775, TC:70.9569, CC:447.5869, OV:3.2628, PN:486.9040
Epoch[5/5], Step[57], Loss:889.9815
NE:0.2401, TC:61.0586, CC:383.5066, OV:1.5296, PN:443.6466
Epoch[5/5], Step[58], Loss:1083.1937
NE:0.2852, TC:70.8628, CC:478.4091, OV:2.8485, PN:530.7881
Epoch[5/5], Step[59], Loss:1262.9532
NE:0.2252, TC:60.2369, CC:708.8602, OV:0.0478, PN:493.5830
Epoch[5/5], Step[60], Loss:1037.2837
NE:0.2723, TC:72.3633, CC:419.5211, OV:8.8815, PN:536.2455
2026-01-12 21:43:23,300 INFO Model saved: D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_5_step_60.pth
Epoch[5/5], Step[61], Loss:787.2324
NE:0.3013, TC:71.7080, CC:260.6901, OV:5.7288, PN:448.8043
Epoch[5/5], Step[62], Loss:674.4662
NE:0.3293, TC:77.2428, CC:227.3191, OV:9.0583, PN:360.5167
2026-01-12 21:43:40,005 INFO Training finished

### Predict ###

2026-01-12 21:43:40,007 INFO Initialising model
Number of genes: 313
2026-01-12 21:43:42,833 INFO Preparing data
Loaded nuclei
(382, 510)
88 patches available
Cell types: ['B', 'CD4Tconv/Treg', 'CD8T/CD8Tex', 'DC', 'Endothelial', 'Epithelial', 'Fibroblasts', 'Malignant', 'Mast', 'Mono/Macro', 'Myofibroblasts', 'NK', 'Neutrophils', 'Plasma', 'SMC']
2026-01-12 21:43:42,889 INFO Total number of patches: 88
2026-01-12 21:43:42,890 INFO Begin prediction
Predict using D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_1_step_60.pth
2026-01-12 21:46:00,756 INFO Preparing data
Loaded nuclei
(382, 510)
70 patches available
Cell types: ['B', 'CD4Tconv/Treg', 'CD8T/CD8Tex', 'DC', 'Endothelial', 'Epithelial', 'Fibroblasts', 'Malignant', 'Mast', 'Mono/Macro', 'Myofibroblasts', 'NK', 'Neutrophils', 'Plasma', 'SMC']
2026-01-12 21:46:00,802 INFO Total number of patches: 70
2026-01-12 21:46:00,802 INFO Begin prediction
Predict using D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small\model_outputs\2026_01_12_21_12_29/models/epoch_1_step_60.pth
2026-01-12 21:47:59,124 INFO Finished
Combining predictions
2 patches available
Num multiprocessing splits: 8
Processing...
Combining results
Saved segmentation to D:\2512-BROCK-CODING\BIDCell\nash_data\dataset_xenium_breast1_small/model_outputs/2026_01_12_21_12_29/test_output/epoch_1_step_60_connected.tif
Number of cells 852
Number of splits for multiprocessing: 8
Segmentation map pixel size:  (1798, 2400)
Saving temporary resized segmentation
Extracting cell expressions
Patch H 0:1798, W 0:2400
(1798, 2400)
Reading filtered transcripts
0.0 508.99520000000007 0.0 380.99484
Transforming x_location
Transforming y_location
0 2395 0 1793
Transforming x_location
Transforming y_location
0 2395 0 1793
Extracting cell-gene matrix chunks
Combining cell-gene matrix chunks
Obtained cell-gene matrix
Done

### Done ###
